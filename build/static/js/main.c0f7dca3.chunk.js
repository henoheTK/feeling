(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{30:function(e,t,n){},45:function(e,t,n){},57:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},82:function(e,t,n){},83:function(e,t,n){},86:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var o=n(2),c=n(3),s=n(32),i=n.n(s),a=n(19),r=n(6),l=n.n(r),d=n(12),u=n(9),m=n(11),j=n(27);j.a.initializeApp({apiKey:"AIzaSyBKyumc6NOpVRBhKbXxz06lN0HP5xztT8Y",authDomain:"emoichat-300700.firebaseapp.com",projectId:"emoichat-300700",storageBucket:"emoichat-300700.appspot.com",messagingSenderId:"349007819425",appId:"1:349007819425:web:3b35c57290d3aac32d36e0",measurementId:"G-8HGXFZXEQT"}),j.a.analytics();var h=j.a,f=j.a.firestore(),p={happy:["leftEye","rightEye","mouth"],angry:["leftEye","rightEye","mouth"],naki:["leftEye","rightEye","mouth"],yurei:["leftEye","rightEye","mouth"],thinking:["leftEye","rightEye","mouth"],henoheno:["leftEye","rightEye","mouth","nose","face"]},b=function(e){var t=function(t){var n,c,s=t.info;return"null"!==e.emotion&&e.emotion&&-1!==p[e.emotion].indexOf(s[0])?(n="../images/icon/"+e.emotion+"_"+s[0]+".png",c=0):(n="../images/icon/"+s[1].kind+"_"+s[0]+".png",c=parseInt(s[1].rot)),Object(o.jsx)("img",{className:e.where+"-iconparts "+s[0],src:n,style:{height:s[1].sizeY/300*e.iconSize+"px",width:s[1].sizeX/300*e.iconSize+"px",top:s[1].posY/300*e.iconSize+"px",left:s[1].posX/300*e.iconSize+"px",position:"absolute",transform:"rotate("+c+"deg)"}},s[0])};return Object(o.jsx)("div",{className:e.where+"-icon",style:{position:"relative",height:e.iconSize+"px",width:e.iconSize+"px"},children:Object.entries(e.iconInfo).map((function(e){return Object(o.jsx)(t,{info:e},e[0])}))})};n(57);var x=function(){var e=Object(c.useContext)(le),t=e.isOnline,n=e.userId,s=e.userInfo,i=Object(c.useState)(null),a=Object(u.a)(i,2),r=a[0],l=a[1],d=Object(c.useState)(null),m=Object(u.a)(d,2),j=m[0],p=m[1];return Object(c.useEffect)((function(){s&&(s.room&&f.collection("rooms").doc(s.room).get().then((function(e){e.exists?p([e.id,e.data().roomName]):f.collection("users").doc(n).update({room:null})})),0!==s.rooms.length?f.collection("rooms").where(h.firestore.FieldPath.documentId(),"in",s.rooms).get().then((function(e){var t={},o=[];e.empty?(l(!1),f.collection("users").doc(n).update({rooms:[]})):(e.docs.forEach((function(e){e.exists&&(t[e.id]=e.data().roomName,o.push(e.id))})),l(t),o.length!==s.rooms.length&&f.collection("users").doc(n).update({rooms:o}))})).catch((function(e){console.log("Error:"+e)})):l(!1))}),[s]),Object(o.jsx)("nav",{className:"navbar navbar-default",style:{margin:"0px"},children:Object(o.jsxs)("div",{className:"container-fluid",children:[Object(o.jsxs)("div",{className:"navbar-header",children:[Object(o.jsxs)("button",{type:"button",className:"navbar-toggle collapsed","data-toggle":"collapse","data-target":"#bs-example-navbar-collapse-1",children:[Object(o.jsx)("span",{className:"sr-only",children:"Toggle navigation"}),Object(o.jsx)("span",{className:"icon-bar"}),Object(o.jsx)("span",{className:"icon-bar"}),Object(o.jsx)("span",{className:"icon-bar"})]}),Object(o.jsx)("a",{className:"navbar-brand",href:"/",children:"\u30a8\u30e2\u3044\u30c1\u30e3\u30c3\u30c8\u3002"})]}),Object(o.jsxs)("div",{className:"collapse navbar-collapse",id:"bs-example-navbar-collapse-1",children:[Object(o.jsxs)("ul",{className:"nav navbar-nav",children:[Object(o.jsx)("li",{className:"",children:Object(o.jsxs)("a",{href:"/",children:["\u30db\u30fc\u30e0",Object(o.jsx)("span",{className:"sr-only",children:"(current)"})]})}),null!==j&&Object(o.jsx)("li",{className:"",children:Object(o.jsxs)("a",{href:"/room/"+j[0],children:[j[1],Object(o.jsx)("span",{className:"sr-only",children:"(current)"})]})}),Object(o.jsxs)("li",{className:"dropdown",children:[Object(o.jsxs)("a",{className:"dropdown-toggle","data-toggle":"dropdown",role:"button","aria-expanded":"false",children:["\u30eb\u30fc\u30e0s ",Object(o.jsx)("span",{className:"caret"})]}),Object(o.jsxs)("ul",{className:"dropdown-menu",role:"menu",children:[Object(o.jsx)("li",{children:"\u3078\u306e\u3078\u306e"}),!1===r&&Object(o.jsx)("li",{children:Object(o.jsx)("p",{children:"\u307e\u3060\u5165\u5ba4\u3057\u3066\u3044\u308b\u30eb\u30fc\u30e0\u304c\u3042\u308a\u307e\u305b\u3093"})}),null!==r&&!1!==r&&Object.entries(r).map((function(e){return Object(o.jsx)("li",{children:Object(o.jsx)("a",{href:"/room/"+e[0],children:e[1]})},e[0])}))]})]})]}),!0===t&&Object(o.jsx)("ul",{className:"nav navbar-nav navbar-right",children:Object(o.jsxs)("li",{id:"userInfo-li",href:"/userSetting",children:[Object(o.jsx)("a",{id:"infoLink-icon",href:"/userSetting"}),Object(o.jsxs)("div",{href:"/userSetting",className:"iconMask barMask",children:[null!==s&&Object(o.jsx)(b,{iconInfo:s.iconinfo,where:"header",iconSize:"50"}),Object(o.jsx)("h6",{id:"icon-loading-text",children:"loading icon..."})]})]})})]})]})})},O=(n(24),n(75),n(76),n(30),function(e){var t=Object(c.useContext)(z).reActions;return Object(o.jsxs)("div",{id:"",className:"reActions icon-acce",children:[console.log(e.renderId,t),t[e.renderId].map((function(e){return Object(o.jsx)("div",{children:Object(o.jsx)("img",{src:"../../../../../images/reactions/"+e.name+".png",className:"reactionImg"})},e.id)}))]})}),g=function(e){var t=Object(c.useContext)(z).newComment;return Object(o.jsx)("div",{className:"balloon1 icon-acce top",children:Object(o.jsx)("div",{className:"balloon1-text",children:Object(o.jsx)("p",{children:t[e.renderId]})})},e.renderId)},v=function(e){var t=Object(c.useContext)(L).room,n=Object(c.useContext)(le).userId,s=function(e){var o=e.target.dataset.name,c=e.target.dataset.user;console.log(o,c),f.collection("rooms").doc(t.id).collection("reActions").add({name:o,from:n,to:c,timeStamp:h.firestore.FieldValue.serverTimestamp()}).then((function(e){setTimeout((function(){f.collection("rooms").doc(t.id).collection("reActions").doc(e.id).delete()}),3e3)})).catch((function(e){console.log(e)}))};return Object(o.jsxs)("div",{className:"icon-acce reActionbuttons",children:[Object(o.jsx)("button",{className:"reActionButton",onClick:s,"data-name":"good","data-user":e.renderId,children:"good"}),Object(o.jsx)("button",{className:"reActionButton",onClick:s,"data-name":"kusa","data-user":e.renderId,children:"\u8349"}),Object(o.jsx)("button",{className:"reActionButton",onClick:s,"data-name":"question","data-user":e.renderId,children:"\uff1f"})]})},y=function(e){var t=Object(c.useContext)(le).userId,n=Object(c.useContext)(z),s=n.emotions,i=n.reActions,a=n.newComment;return Object(o.jsxs)("div",{className:"stageIcon",children:[console.log(e.renderInfo),e.renderInfo[0]!==t&&Object(o.jsx)("h3",{className:"stageIcon-displayName icon-acce",children:e.renderInfo[1].displayName}),e.renderInfo[0]===t&&Object(o.jsx)("h3",{className:"self-mark stageIcon-displayName icon-acce",children:e.renderInfo[1].displayName}),null===a&&Object(o.jsx)("p",{className:"icon-acce",children:"Loading NewComment..."}),null!==a&&a[e.renderInfo[0]]&&Object(o.jsx)(g,{renderId:e.renderInfo[0]}),Object(o.jsx)(b,{iconInfo:e.renderInfo[1].iconInfo,iconSize:200,emotion:s[e.renderInfo[0]],where:"stage"}),e.renderInfo[0]!==t&&Object(o.jsx)(v,{renderId:e.renderInfo[0]}),null===i&&Object(o.jsx)("p",{className:"icon-acce",children:"Loading Actions..."}),null!==i&&i[e.renderInfo[0]]&&Object(o.jsx)(O,{renderId:e.renderInfo[0]})]})};var I=function(e){var t=Object(c.useContext)(L),n=t.members,s=t.room;return Object(o.jsxs)("div",{id:"nomal",children:[console.log(Object.keys(n),s,n,s.members,s.members,s.members[0],n[s.members[0]]),Object.keys(n).map((function(e,t){return Object(o.jsx)("div",{className:"icondiv",children:Object(o.jsx)(y,{renderInfo:[s.members[t],n[s.members[t]]]})},"icondiv"+t)}))]})},N=function(){var e=Object(c.useContext)(L).room,t=Object(c.useContext)(z),n=t.emotions,s=(t.setEmotions,Object(c.useContext)(le)),i=s.userId,a=s.userInfo;function r(){var t=document.getElementById("inputComment").value;if(t.length>0&&t.length<=300){var o,c=e.id;o=n[i]?n[i]:null,f.collection("rooms").doc(c).collection("comments").add({content:t,userId:i,userName:a.displayName,emotion:o,timeStamp:h.firestore.FieldValue.serverTimestamp()}),f.collection("rooms").doc(e.id).collection("newComment").doc(i).set({content:t,timeStamp:h.firestore.FieldValue.serverTimestamp()}).then((function(){document.getElementById("inputComment").value="",setTimeout((function(){f.collection("rooms").doc(e.id).collection("newComment").doc(i).delete()}),6e3)}))}}Object(c.useEffect)((function(){document.body.addEventListener("keydown",(function(e){"Enter"===e.key&&e.ctrlKey&&r()}))}),[]);var l=function(t){var n=t.target.dataset.kind;console.log(n),null===n?f.collection.doc(e.id).collection("emotions").doc(i).delete():f.collection("rooms").doc(e.id).collection("emotions").doc(i).set({kind:n,timeStamp:h.firestore.FieldValue.serverTimestamp()})};return Object(o.jsxs)("div",{id:"commentForm",children:[Object(o.jsxs)("div",{id:"emotions",children:[Object(o.jsx)("button",{className:"emotoButton",onClick:l,"data-kind":"henoheno",children:"\u3078\u306e\u3078\u306e"}),Object(o.jsx)("button",{className:"emotoButton",onClick:l,"data-kind":"null",children:"\u306a\u3057"}),Object(o.jsx)("button",{className:"emotoButton",onClick:l,"data-kind":"yurei",children:"\u30e6\u30fc\u30ec\u30a4"}),Object(o.jsx)("button",{className:"emotoButton",onClick:l,"data-kind":"happy",children:"\u30cb\u30b3\u30cb\u30b3"}),Object(o.jsx)("button",{className:"emotoButton",onClick:l,"data-kind":"angry",children:"\u6012\u308a"}),Object(o.jsx)("button",{className:"emotoButton",onClick:l,"data-kind":"naki",children:"\u6ce3\u304d"})]}),Object(o.jsxs)("div",{className:"form",children:[Object(o.jsx)("input",{id:"inputComment"}),Object(o.jsx)("button",{type:"submit",maxLength:"300",onClick:r,children:"\u6295\u7a3f"})]})]})},E=n(23);function w(e){return Math.floor(Math.random()*Math.floor(e))-e/2}var k=function(e,t){return setInterval((function(){!function(e,t,n){var o=window.getComputedStyle(e,null).getPropertyValue("transform").substr(7).split(",").slice(0,4);e.style.transform="matrix("+o[0]+","+o[1]+","+o[2]+","+o[3]+","+w(t)+","+w(n)+")"}(e,5,5)}),t)};var z=Object(c.createContext)([]),C=function(e){Object(c.useContext)(le).userId;var t=Object(c.useContext)(L),n=(t.icons,t.splitSize,t.room),s=Object(c.useState)(null),i=Object(u.a)(s,2),a=i[0],r=i[1],m=Object(c.useState)({}),j=Object(u.a)(m,2),h=j[0],p=j[1],b=Object(c.useState)({}),x=Object(u.a)(b,2),O=x[0],g=x[1],v=n.id;return Object(c.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,n=new Date(t.getTime()-5e3),console.log(n,t),e.next=5,f.collection("/rooms").doc(v).collection("emotions").where("timeStamp",">",n).onSnapshot((function(e){console.log(e);var t=[],n=e.docs.map((function(e){return e.id}));e.forEach((function(e){t.push(e.data())}));for(var o={},c=0;c<n.length;c++)o[n[c]]=t[c].kind;console.log(e,t,o,"\u3093"),p(o)}));case 5:return o=e.sent,e.abrupt("return",(function(){return o()}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(d.a)(l.a.mark((function e(){var t,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,n=new Date(t.getTime()-6e3),e.next=4,f.collection("/rooms").doc(v).collection("newComment").where("timeStamp",">",n).onSnapshot((function(e){var t=[],n=e.docs.map((function(e){return e.id}));e.forEach((function(e){t.push(e.data())}));for(var o={},c=0;c<n.length;c++)o[n[c]]=t[c].content;console.log(e,t,o,"\u3093"),r(o)}));case 4:return o=e.sent,e.abrupt("return",(function(){return o()}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function n(){return(n=Object(d.a)(l.a.mark((function e(){var t,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,n=new Date(t.getTime()-5e3),console.log(n,t),e.next=5,f.collection("/rooms").doc(v).collection("reActions").where("timeStamp",">",n).onSnapshot((function(e){var t=[],n=e.docs.map((function(e){return e.id}));e.forEach((function(e){t.push(e.data())}));for(var o={},c=0;c<n.length;c++)o[t[c].to]||(o[t[c].to]=[]),o[t[c].to].push({id:n[c],name:t[c].name,from:t[c].from,to:t[c].to});console.log(e,t,o,"\u3093"),g(o)}));case 5:return o=e.sent,e.abrupt("return",(function(){return o()}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}(),function(){n.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){var e=function(){for(var e=[],t=0;t<e.length;t++)clearInterval(e[t]);e=[];for(var n=document.getElementsByClassName("stage-iconparts"),o=0;o<n.length;o++)e.push(k(n[o],1e3));return e}();return function(){e.forEach((function(e){clearInterval(e)}))}})),Object(o.jsx)(z.Provider,{value:{newComment:a,setNewComment:r,emotions:h,setEmotions:p,reActions:O,setActions:g},children:Object(o.jsxs)(E.a,{split:"horizontal",defaultSize:window.innerHeight-171,children:[Object(o.jsx)("div",{id:"stage",children:Object(o.jsx)(I,{stageRadius:600})}),Object(o.jsx)(N,{})]})})};n(80),n(81),n(82);function S(e,t){return B.apply(this,arguments)}function B(){return(B=Object(d.a)(l.a.mark((function e(t,n){var o,c,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("rooms").doc(t).collection(n).get();case 2:return(o=e.sent).empty||(c=0,s=0,(i=[]).push(f.batch()),o.docs.forEach((function(e){i[c].delete(e.ref),499===++s&&(i.push(f.batch()),c++,s=0)})),i.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.commit();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var K,X=function(){var e=Object(c.useContext)(L).room,t=Object(c.useContext)(le).userId;return Object(o.jsxs)("header",{id:"room-header",children:[Object(o.jsx)("div",{id:"room-name",children:Object(o.jsx)("strong",{children:e.roomName})}),Object(o.jsxs)("ul",{id:"room-info",children:[Object(o.jsxs)("li",{children:["\u53c2\u52a0\u8005\uff1a",e.members.length]}),Object(o.jsxs)("li",{children:[" \u4f5c\u6210\u8005\uff1a",e.madeUserName]}),Object(o.jsxs)("li",{children:[" \u4f5c\u6210\u65e5\u6642\uff1a",e.madeTime]}),Object(o.jsxs)("li",{children:[" \u30e1\u30f3\u30d0\u30fc\uff1a",e.members.length,"\u4eba"]})]}),console.log(e,e.madeUserId,t),e.madeUserId===t&&Object(o.jsx)("button",{onClick:function(){if(window.confirm("\u3053\u306e\u64cd\u4f5c\u306f\u53d6\u308a\u6d88\u305b\u307e\u305b\u3093\u3001\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")){var t=f.collection("/rooms").doc(e.id),n=e.id;t&&S(n,"newComment").then((function(){S(n,"emotions").then((function(){S(n,"reActions").then((function(){S(n,"comments").then((function(){t.delete().then((function(){}))}))}))}))})).catch((function(e){console.log("Error:"+e)}))}},children:"\u30eb\u30fc\u30e0\u3092\u524a\u9664"})]})},Y=(n(83),n(46)),L=Object(c.createContext)([]),U=function(){var e=Object(c.useState)(null),t=Object(u.a)(e,2),n=t[0],s=t[1],i=Object(c.useState)(null),a=Object(u.a)(i,2),r=a[0],m=a[1],j=Object(c.useState)(null),p=Object(u.a)(j,2),b=p[0],x=p[1],O=Object(c.useState)(800),g=Object(u.a)(O,2),v=g[0],y=g[1],I=Object(c.useState)(null),N=Object(u.a)(I,2),w=N[0],k=N[1],z=Object(c.useContext)(le),S=(z.isOnline,z.userId),B=(z.userInfo,window.location.pathname.split("/")[2]);return Object(c.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("/rooms").doc(B).onSnapshot((function(e){if(e.exists){var t=e.data();-1===t.members.indexOf(S)?(console.log("\u5165\u5ba4\u3057\u307e\u3057\u305f"),f.collection("rooms").doc(B).update({members:h.firestore.FieldValue.arrayUnion(S)}).then((function(){f.collection("users").doc(S).update({rooms:h.firestore.FieldValue.arrayUnion(B)}).catch((function(e){console.log("Error:"+e)})).then((function(){m(!0)})),f.collection("users").doc(S).update({room:B}).catch((function(e){console.log("Error:"+e)}))})).catch((function(e){console.log("Error:"+e)}))):m(!0);var n=t.timeStamp.toDate(),o={id:e.id,roomName:t.roomName,stageId:t.stageId,madeTime:n.getFullYear()+"/"+n.getMonth()+"1/"+n.getDate(),madeUserId:t.madeUserId,madeUserName:t.madeUserName,members:t.members};s(o)}else m(!1)}));case 2:return t=e.sent,e.abrupt("return",(function(){return t()}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return console.log(n),e.next=4,f.collection("/rooms").doc(B).collection("comments").orderBy("timeStamp","asc").onSnapshot((function(e){var t=e.docs.map((function(e){return e.id})),n=[];e.forEach((function(e){n.push(e.data())}));for(var o=[],c=0;c<t.length;c++)o.push({id:t[c],content:n[c].content,emotion:n[c].emotion,userId:n[c].userId});console.log(t,o,e),x(o)}));case 4:return t=e.sent,e.abrupt("return",(function(){return t()}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=5;break}return e.next=3,f.collection("rooms").doc(B).onSnapshot(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.exists){e.next=6;break}if(n=t.data().members,console.log(n),!n||0===n.length){e.next=6;break}return e.next=6,f.collection("users").where("userId","in",n).get().then((function(e){if(!e.empty){console.log(e);var t={};e.docs.forEach((function(e){var n=e.data(),o=e.data().userId;t[o]={displayName:n.displayName,oneWord:n.oneWord,iconInfo:n.iconinfo}})),console.log(t,e,e.docs),k(t)}}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return t=e.sent,e.abrupt("return",(function(){return t()}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[r]),Object(o.jsxs)("div",{className:"container",children:[null===r&&Object(o.jsx)("p",{children:"Loading Room..."}),!0===r&&Object(o.jsxs)(L.Provider,{value:{members:w,setMembers:k,room:n,setRoom:s,comments:b,setComments:x,splitSize:v,setSplitSize:y},children:[null===n&&Object(o.jsx)("p",{children:"Loading Room..."}),n&&Object(o.jsxs)("div",{className:"row",children:[Object(o.jsx)(X,{}),Object(o.jsxs)(E.a,{split:"vertical",minSize:300,defaultSize:800,maxSize:1e3,style:{height:window.innerHeight-101},children:[Object(o.jsxs)("div",{id:"left",style:{display:"flex"},children:[null===w&&Object(o.jsx)("p",{children:"Loading Stage..."}),null!==w&&Object(o.jsx)(C,{})]}),Object(o.jsxs)("div",{id:"right",children:[null===b&&Object(o.jsx)("p",{children:"Loading Ccomments..."}),null!==b&&Object(o.jsx)(T,{})]})]})]})]}),0==r&&Object(o.jsx)(Y.Redirect,{to:"/error"})]})},T=(n(86),function(){var e=Object(c.useContext)(L),t=e.comments,n=(e.room,e.members);window.location.pathname;return Object(c.useEffect)((function(){var e=document.getElementById("scroll-inner");console.log(e),e.scrollIntoView(!1);var t=function(){for(var e=[],t=0;t<e.length;t++)clearInterval(e[t]);e=[];for(var n=document.getElementsByClassName("comments-iconparts"),o=0;o<n.length;o++)e.push(k(n[o],1e3));return e}();return function(){t.forEach((function(e){clearInterval(e)}))}})),Object(o.jsx)("div",{id:"comments",className:"list-group",children:Object(o.jsx)("div",{id:"scroll-inner",children:t&&n&&t.map((function(e){return Object(o.jsxs)("div",{className:"comment list-group-item d-flex",children:[Object(o.jsx)("div",{className:"iconMask commentIcon",children:Object(o.jsx)(b,{iconInfo:n[e.userId].iconInfo,iconSize:50,emotion:e.emotion,where:"comments"})}),Object(o.jsxs)("div",{children:[console.log(n),Object(o.jsx)("strong",{className:"userName mb-1",style:{},children:n[e.userId].displayName}),Object(o.jsx)("h3",{className:"commentContent",style:{},children:e.content})]})]},e.id.toString())}))})})}),A=(n(45),n(26));var F={face:{displayName:"\u9854",Kinds:{henoheno:{displayKind:"\u3058"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},monster:{displayKind:"\u5316\u7269"},komugi:{displayKind:"\u5c0f\u9ea6\u8272"},maru:{displayKind:"\u307e\u308b"}}},hair:{displayName:"\u9aea",Kinds:{none:{displayKind:"\u306a\u3057"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},cat:{displayKind:"\u30b1\u30e2\u30df\u30df"},tyuni:{displayKind:"\u53a8\u4e8c"},kaku:{displayKind:"\u30ab\u30af\u30ac\u30ea"}}},leftEye:{displayName:"\u5de6\u76ee",Kinds:{henoheno:{displayKind:"\u3078\u306e"},no:{displayKind:"\u306e"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},cat:{displayKind:"\u306d\u3053"},red:{displayKind:"\u7d05"},blue:{displayKind:"\u84bc"},tyome:{displayKind:"\u30b3\u30e1"}}},rightEye:{displayName:"\u53f3\u76ee",Kinds:{henoheno:{displayKind:"\u3078\u306e"},no:{displayKind:"\u306e"},cat:{displayKind:"\u306d\u3053"},red:{displayKind:"\u7d05"},blue:{displayKind:"\u84bc"},tyome:{displayKind:"\u30b3\u30e1"}}},nose:{displayName:"\u9f3b",Kinds:{henoheno:{displayKind:"\u3082"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},cat:{displayKind:"\u9006\u4e09\u89d2"},pig:{displayKind:"\u3076\u305f\u3063\u3071\u306a"}}},mouth:{displayName:"\u53e3",Kinds:{henoheno:{displayKind:"\u3078"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},cat:{displayKind:"\u30c0\u30d6\u30ea\u30e5\u30fc"},fang:{displayKind:"\u7259"},tooth:{displayKind:"\u6b6f"}}},other:{displayName:"\u305d\u306e\u4ed6",Kinds:(K={none:{displayKind:"\u306a\u3057"},hige:{displayKind:"\u3072\u3052"}},Object(A.a)(K,"hige",{displayKind:"\u3072\u3052"}),Object(A.a)(K,"horns",{displayKind:"\u30c4\u30ce"}),Object(A.a)(K,"glasses",{displayKind:"\u3081\u304c\u306d"}),Object(A.a)(K,"henoheno",{displayKind:"\u3078\u306e\u3078\u306e"}),K)}};var M={face:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"nomal"},hair:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"nomal"},leftEye:{posX:0,posY:0,sizeX:50,sizeY:50,rot:0,kind:"nomal"},rightEye:{posX:0,posY:0,sizeX:50,sizeY:50,rot:0,kind:"nomal"},nose:{posX:0,posY:0,sizeX:50,sizeY:50,rot:0,kind:"nomal"},mouth:{posX:0,posY:0,sizeX:50,sizeY:50,rot:0,kind:"nomal"},other:{posX:0,posY:0,sizeX:50,sizeY:50,rot:0,kind:"nomal"}};function R(e,t){return M[e][t]}var V={face:{max:350,min:200},hair:{max:350,min:200},leftEye:{max:70,min:15},rightEye:{max:70,min:15},mouth:{max:100,min:15},nose:{max:100,min:15},other:{max:400,min:30}};function D(e){return V[e].max}function P(e){return V[e].min}var W={face:{sizeX:300,sizeY:300},hair:{sizeX:300,sizeY:300},leftEye:{sizeX:30,sizeY:30},rightEye:{sizeX:30,sizeY:30},mouth:{sizeX:40,sizeY:40},nose:{sizeX:40,sizeY:40},other:{sizeX:300,sizeY:300}};function G(e,t,n){W[e]={sizeX:t,sizeY:n}}var _={face:{max:360,min:0},hair:{max:360,min:0},leftEye:{max:360,min:0},rightEye:{max:360,min:0},mouth:{max:360,min:0},nose:{max:360,min:0},other:{max:360,min:0}};function H(e){return _[e].max}function J(e){return _[e].min}var Z={face:0,hair:0,leftEye:0,rightEye:0,mouth:0,nose:0,other:0};function q(e,t){console.log(t),Z[e]=t}n(87);var Q=function(){var e,t=Object(c.useContext)(ee),n=t.setNowKind,s=(t.nowKind,t.nowName);return Object(o.jsxs)("div",{id:"makeIconButtons",className:s+"button",children:[console.log(s),Object.entries((e=s,console.log(e),F[e].Kinds)).map((function(e){return Object(o.jsx)("button",{className:e[0]+" "+s+" iconKindButton btn-text-3d","data-name":s,"data-kind":e[0],onClick:function(e){n(e.target.dataset.kind),document.getElementsByClassName("iconKindButton").forEach((function(e){e.classList.contains("active")&&e.classList.remove("active")})),e.target.classList.add("active")},children:e[1].displayKind},e[0])}))]})},$="./images/icon/",ee=Object(c.createContext)([]),te=function(){var e=Object(c.useState)(null),t=Object(u.a)(e,2),n=t[0],s=t[1],i=Object(c.useState)("face"),a=Object(u.a)(i,2),r=a[0],l=a[1],d=Object(c.useState)(30),m=Object(u.a)(d,2),j=m[0],h=m[1],f=Object(c.useState)(0),p=Object(u.a)(f,2),b=p[0],x=p[1],O=Object(c.useContext)(le).userInfo;Object(c.useEffect)((function(){var e;O&&(e=O.iconinfo,M=e,Object.entries(O.iconinfo).forEach((function(e){G(e[0],e[1].sizeX,e[1].sizeY),q(e[0],e[1].rot);var t=document.getElementById(e[0]+"Img");t||((t=document.createElement("img")).classList.add("set-image"),t.classList.add(e[0]),t.id=e[0]+"Img"),v(t,e[1].sizeX,e[1].sizeY,e[1].posX,e[1].posY,e[1].rot,e[1].kind,e[0])})));var t=R(r,"kind");document.getElementsByClassName("iconNameButton").forEach((function(e){console.log(e),e.classList.contains(r)&&e.classList.add("active")})),document.getElementsByClassName("iconKindButton").forEach((function(e){e.classList.contains(t)&&e.classList.add("active")})),s(R(r,"kind"))}),[O]),Object(c.useEffect)((function(){var e=R(r,"kind");document.getElementsByClassName("iconKindButton").forEach((function(t){t.classList.contains("active")&&t.classList.remove("active"),t.classList.contains(e)&&t.classList.add("active")})),s(e)}),[r]);var g,v=function(e,t,n,o,c,s,i,a){e.src=$+i+"_"+a+".png",e.style.width=t+"px",e.style.height=n+"px",e.style.position="absolute",e.style.left=o+"px",e.style.top=c+"px",e.style.transform="rotate("+s+"deg)";var r={posX:o,posY:c,sizeX:t,sizeY:n,rot:s,kind:i};document.getElementById("icon-space").appendChild(e),function(e,t){M[e]=t}(a,r)};var y,I=function(e){e||(e=r);var t,n=document.getElementById("rotInput"),o=n.value,c=H(e),s=J(e);q(e,t=c<o?c:s>o?s:o),x(t),n.value=t},N=function(e){e||(e=r);var t,n=document.getElementById("sizeInput"),o=n.value,c=D(e),s=P(e);G(e,t=c<o?c:s>o?s:o,t),h(t),n.value=t};Object(c.useContext)(le).userId;return Object(o.jsxs)("div",{id:"makeIcon",children:[null===O&&Object(o.jsx)("p",{children:"loading infos..."}),null!==O&&Object(o.jsxs)(ee.Provider,{value:{nowKind:n,setNowKind:s,nowName:r,setNowName:l,nowSize:j,setNowSize:h,nowRot:b,setNowRot:x},children:[Object(o.jsx)("div",{id:"icon-space",className:"iconMask",onMouseMove:function(e){var t=e.clientX-Math.floor(j/2),n=e.clientY-Math.floor(j/2);document.getElementById("traceImage").style.top=n+"px",document.getElementById("traceImage").style.left=t+"px"},onMouseLeave:function(){document.getElementById("traceImage").style.display="none"},onMouseEnter:function(){document.getElementById("traceImage").style.display="block"},onClick:function(e){N(),I();var t=document.getElementById(r+"Img");t||((t=document.createElement("img")).classList.add("set-image"),t.classList.add(r+"Img"),t.id=r);var o=document.getElementById("icon-space").getBoundingClientRect(),c=window.pageXOffset+o.left,s=window.pageYOffset+o.top,i=e.clientX,a=e.clientY,l=i-c-Math.floor(document.getElementById("sizeInput").value/2),d=a-s-Math.floor(document.getElementById("sizeInput").value/2);v(t,document.getElementById("sizeInput").value,document.getElementById("sizeInput").value,l,d,document.getElementById("rotInput").value,n,r),document.getElementById("save-button").classList.add("active")}}),console.log($+n+r+"png"),Object(o.jsx)("img",{id:"traceImage",src:$+n+"_"+r+".png",style:{height:j+"px",width:j+"px",zIndex:"100",position:"absolute",display:"none",cursor:"none",pointerEvents:"none",transform:"rotate("+b+"deg)"}}),Object(o.jsxs)("div",{children:["\u56de\u8ee2",Object(o.jsx)("input",{type:"number",id:"rotInput",onInput:function(e){y&&clearTimeout(y),y=setTimeout(I,1e3)},min:J(r),max:H(r),defaultValue:"0"}),"\u30b5\u30a4\u30ba",Object(o.jsx)("input",{type:"number",id:"sizeInput",onInput:function(e){g&&clearTimeout(g),g=setTimeout(N,1e3)},min:P(r),max:D(r),defaultValue:"30"})]}),Object(o.jsx)("div",{id:"name-buttons",className:"",children:Object.entries(F).map((function(e){return Object(o.jsx)("button",{id:e[0]+"IconNameButton",className:e[0]+" iconNameButton btn-border_buttom","data-name":e[0],onClick:function(e){var t;document.getElementsByClassName("iconNameButton").forEach((function(e){e.classList.contains("active")&&e.classList.remove("active")})),l(e.target.dataset.name),s(R(e.target.dataset.name,"kind")),document.getElementById("sizeInput").value=(t=e.target.dataset.name,console.log(t,W[t].sizeX),W[t].sizeX),document.getElementById("rotInput").value=function(e){return Z[e]}(e.target.dataset.name),N(e.target.dataset.name),I(e.target.dataset.name)},children:e[1].displayName},e[0])}))}),Object(o.jsx)(Q,{})]})]})},ne=function(){var e=Object(c.useContext)(le),t=e.setUserId,n=(e.setUserName,e.setIsOnline),s=e.isOnline,i=function(){h.auth().signOut(),n(!1),t(null)};return Object(o.jsxs)("div",{children:[!0===s&&Object(o.jsxs)("div",{children:["\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3057\u305f\uff01",Object(o.jsx)(m.Redirect,{to:"/userSetting"})]}),!1===s&&Object(o.jsxs)("div",{children:["\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u305b\u3093",Object(o.jsx)("button",{onClick:function(){de=!0,h.auth().setPersistence(h.auth.Auth.Persistence.LOCAL).then(function(){var e=new h.auth.GoogleAuthProvider;h.auth().signInWithPopup(e).then(function(){var e=Object(d.a)(l.a.mark((function e(o){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("/users").where("userId","==",o.user.uid).get().then((function(e){console.log(e),e.empty?(console.log("No user"),f.collection("users").doc(o.user.uid).set({userId:o.user.uid,displayName:"\u30b2\u30b9\u30c8",oneWord:"",room:null,rooms:[],iconinfo:{face:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"nomal"},hair:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"nomal"},leftEye:{posX:0,posY:0,sizeX:30,sizeY:30,rot:0,kind:"nomal"},rightEye:{posX:0,posY:0,sizeX:30,sizeY:30,rot:0,kind:"nomal"},nose:{posX:0,posY:0,sizeX:30,sizeY:30,rot:0,kind:"nomal"},mouth:{posX:0,posY:0,sizeX:30,sizeY:30,rot:0,kind:"nomal"},other:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"none"}}}).then(function(){var e=Object(d.a)(l.a.mark((function e(c){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("users").doc(o.user.uid).collection("seclet").doc(o.user.uid).set({userName:o.user.displayName,email:o.user.email}).then((function(){console.log("login fin"),n(!0),t(o.user.uid)})).catch((function(e){f.collection("users").doc(o.user.uid).delete().then((function(){i(),alert("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3001\u3082\u3046\u4e00\u5ea6\u30ed\u30b0\u30a4\u30f3\u3092\u304a\u9858\u3044\u3057\u307e\u3059\u3002Error:"+e),console.log(e)}))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){i(),alert("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3001\u3082\u3046\u4e00\u5ea6\u30ed\u30b0\u30a4\u30f3\u3092\u304a\u9858\u3044\u3057\u307e\u3059\u3002Error:"+e),console.log(e)}))):(n(!0),t(o.user.uid))})).catch((function(e){console.log("Error : ",e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}().bind(this)).catch((function(e){return alert("Google\u3067\u30b5\u30a4\u30f3\u30a4\u30f3\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 Error: ",e),console.log(e),!1}))}.bind(undefined))},children:"Google\u3067\u30ed\u30b0\u30a4\u30f3"})]}),null===s&&Object(o.jsx)(o.Fragment,{children:"loading aouth..."})]})},oe=(n(90),function(){var e=Object(c.useContext)(le),t=e.setIsOnline,n=(e.isOnline,e.setUserId),s=e.userId,i=e.userInfo,a=function(){h.auth().signOut(),t(!1),n(null)};return Object(o.jsxs)("div",{children:[null===i&&Object(o.jsx)("p",{children:"Loading userInfo..."}),i&&Object(o.jsxs)("div",{children:[Object(o.jsxs)("ul",{children:[Object(o.jsxs)("li",{children:[Object(o.jsx)("h4",{children:"\u8868\u793a\u540d"}),Object(o.jsx)("input",{id:"displayName-input",type:"text",maxLength:"15",defaultValue:i.displayName,onChange:function(){document.getElementById("save-button").classList.add("active")}})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("h4",{children:"\u3072\u3068\u3053\u3068"}),Object(o.jsx)("h3",{children:Object(o.jsx)("input",{id:"oneWord-input",type:"text",maxLength:"30",defaultValue:i.oneWord,onChange:function(){document.getElementById("save-button").classList.add("active")}})})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("h4",{children:"\u540d\u524d"}),Object(o.jsx)("h3",{children:i.userName})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("h4",{children:"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9"}),Object(o.jsx)("h3",{children:i.email})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("h4",{children:"Google\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u3059"}),Object(o.jsx)("button",{onClick:a,children:"\u30ed\u30b0\u30a2\u30a6\u30c8"})]})]}),Object(o.jsx)(o.Fragment,{children:"\u8a2d\u5b9a\u304c\u7d42\u308f\u3063\u305f\u3089\u3001"}),Object(o.jsx)("a",{href:"/",children:"\u30db\u30fc\u30e0"}),Object(o.jsx)(o.Fragment,{children:"\u306b\u79fb\u52d5\u3057\u3066\u30eb\u30fc\u30e0\u306b\u53c2\u52a0\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01"}),Object(o.jsx)("br",{}),Object(o.jsx)("a",{id:"save-button",onClick:function(){if(document.getElementById("save-button").classList.contains("active")){var e=document.getElementById("displayName-input").value,t=document.getElementById("oneWord-input").value;f.collection("users").doc(s).update({displayName:e,oneWord:t}).then((function(e){var t=M;f.collection("users").doc(s).update({iconinfo:t}).then((function(){document.location.reload()})).catch((function(e){console.log(e)}))})).catch((function(e){a(),alert("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u7533\u3057\u8a33\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u3082\u3046\u4e00\u5ea6\u30ed\u30b0\u30a4\u30f3\u3092\u304a\u9858\u3044\u3057\u307e\u3059\u3002Error:"+e),console.log(e)}))}},children:"\u5909\u66f4\u3092\u4fdd\u5b58"})]})]})}),ce=(n(91),function(){var e=Object(c.useContext)(le),t=e.isOnline;e.setIsOnline,e.userId,e.setUserId,e.userInfo,e.setUserInfo;return Object(o.jsxs)("div",{children:[null===t&&Object(o.jsx)("p",{children:"loading...."}),!0===t&&Object(o.jsxs)("div",{id:"settings",children:[Object(o.jsx)(te,{}),Object(o.jsx)(oe,{})]}),!1===t&&Object(o.jsx)(ne,{})]})}),se=function(){var e=Object(c.useContext)(le),t=e.userId,n=e.userInfo;return Object(o.jsxs)("div",{id:"roomForm",children:[Object(o.jsx)("label",{htmlFor:"name",children:"\u30eb\u30fc\u30e0\u306e\u540d\u524d"}),Object(o.jsx)("input",{id:"nameInput",type:"text",name:"name",maxLength:"15"}),Object(o.jsx)("br",{}),Object(o.jsx)("label",{htmlFor:"stage",defaultValue:"0",children:"\u30b9\u30c6\u30fc\u30b8"}),Object(o.jsxs)("select",{id:"stage",name:"stage",className:"custom-select",children:[Object(o.jsx)("option",{value:"0",children:"Zero"}),Object(o.jsx)("option",{value:"1",children:"One"}),Object(o.jsx)("option",{value:"2",children:"Two"})]}),Object(o.jsx)("br",{}),Object(o.jsx)("button",{onClick:function(){var e=document.getElementById("nameInput").value;if(e.length>0&&e.length<=15){var o=document.getElementById("stage").value;f.collection("/rooms").add({roomName:e,stageId:o,madeUserId:t,madeUserName:n.displayName,timeStamp:h.firestore.FieldValue.serverTimestamp(),members:[]}).then((function(e){})).catch((function(e){alert("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u7533\u3057\u8a33\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u3057\u3070\u3089\u304f\u5f85\u3063\u3066\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\nError:"+e)}))}else alert("\u30eb\u30fc\u30e0\u540d\u306f1\u6587\u5b57\u4ee5\u4e0a\u300115\u6587\u5b57\u4ee5\u4e0b\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002")},children:"\u6295\u7a3f"})]})},ie=(n(92),function(){var e=Object(c.useState)(null),t=Object(u.a)(e,2),n=t[0],s=t[1];return Object(c.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("/rooms").orderBy("timeStamp","asc").get().then((function(e){var t=e.docs.map((function(e){return e.id})),n=[];e.forEach((function(e){n.push(e.data())}));for(var o=[],c=0;c<t.length;c++){var i=n[c].timeStamp.toDate();o.push({roomName:n[c].roomName,stageId:n[c].stageId,madeTime:i.getFullYear()+"/"+i.getMonth()+"1/"+i.getDate(),madeUserName:n[c].madeUserName,madeUserId:n[c].madeUserId,members:n[c].members,id:t[c]})}s(o)}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(o.jsxs)("div",{id:"rooms",className:"list-group",children:[null===n&&Object(o.jsx)("p",{children:"Loading rooms..."}),n&&n.map((function(e){return Object(o.jsxs)("li",{className:"roomsItem list-group-item d-flex",children:[Object(o.jsx)(a.b,{to:"/room/".concat(e.id),children:Object(o.jsx)("h4",{children:e.roomName})}),Object(o.jsxs)("h4",{children:["\u4f5c\u6210\u8005\uff1a",e.madeUserName]}),Object(o.jsxs)("h4",{children:["\u4f5c\u6210\u65e5\u6642\uff1a",e.madeTime]}),Object(o.jsxs)("h4",{children:["\u30e1\u30f3\u30d0\u30fc\uff1a",e.members.length,"\u4eba"]})]},e.id)})),n&&0===n.length&&Object(o.jsx)("li",{className:"roomsItem list-group-item d-flex",children:Object(o.jsx)("h4",{children:"\u307e\u3060\u30eb\u30fc\u30e0\u306f\u3042\u308a\u307e\u305b\u3093"})},"none room")]})}),ae=function(){return Object(o.jsxs)("div",{id:"roomsAndForm",children:[Object(o.jsx)(ie,{}),Object(o.jsx)(se,{})]})},re=function(){return Object(o.jsx)("div",{children:Object(o.jsx)("p",{children:"\u30da\u30fc\u30b8\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u524a\u9664\u30fb\u5909\u66f4\u3055\u308c\u305f\u304b\u3001URL\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002"})})},le=Object(c.createContext)(),de=!1;var ue=function(){var e=Object(c.useState)(null),t=Object(u.a)(e,2),n=t[0],s=t[1],i=Object(c.useState)(null),a=Object(u.a)(i,2),r=a[0],j=a[1],p=Object(c.useState)(null),b=Object(u.a)(p,2),O=b[0],g=b[1];return Object(c.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=5;break}return e.next=3,f.collection("users").doc(r).onSnapshot((function(e){f.collection("users").doc(r).collection("seclet").doc(r).get().then((function(t){var n=e.data(),o=t.data();g({userName:o.userName,email:o.email,displayName:n.displayName,oneWord:n.oneWord,iconinfo:n.iconinfo,rooms:n.rooms,room:n.room})}))}));case 3:return t=e.sent,e.abrupt("return",(function(){return t()}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[r]),Object(c.useEffect)((function(){h.auth().onAuthStateChanged(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,o=null,t&&(o=t.uid,n=!0),de||(j(o),s(n));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}().bind(undefined))})),Object(o.jsx)("div",{children:Object(o.jsxs)(le.Provider,{value:{isOnline:n,setIsOnline:s,userId:r,setUserId:j,userInfo:O,setUserInfo:g},children:[Object(o.jsx)(x,{}),Object(o.jsxs)(m.Switch,{children:[Object(o.jsx)(m.Route,{exact:!0,path:"/login",component:ne}),!1===n&&Object(o.jsx)(m.Redirect,{to:"/login"}),!0===n&&Object(o.jsxs)(m.Switch,{children:[Object(o.jsx)(m.Route,{exact:!0,path:"/error",component:re}),Object(o.jsx)(m.Route,{exact:!0,path:"/",component:ae}),Object(o.jsx)(m.Route,{exact:!0,path:"/userSetting",component:ce}),Object(o.jsx)(m.Route,{exact:!0,path:"/room/:id",component:U}),Object(o.jsx)(m.Redirect,{to:"/error"})]}),Object(o.jsx)(o.Fragment,{children:"loading..."})]})]})})};n(93);i.a.render(Object(o.jsx)(a.a,{children:Object(o.jsx)(ue,{})}),document.getElementById("root"))}},[[94,1,2]]]);
//# sourceMappingURL=main.c0f7dca3.chunk.js.map