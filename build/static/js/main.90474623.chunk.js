(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{29:function(e,t,n){},44:function(e,t,n){},56:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){},85:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var o=n(2),s=n(3),i=n(31),c=n.n(i),r=n(19),a=n(6),l=n.n(a),d=n(12),u=n(9),m=n(11),h=n(26);h.a.initializeApp({apiKey:"AIzaSyBKyumc6NOpVRBhKbXxz06lN0HP5xztT8Y",authDomain:"emoichat-300700.firebaseapp.com",projectId:"emoichat-300700",storageBucket:"emoichat-300700.appspot.com",messagingSenderId:"349007819425",appId:"1:349007819425:web:3b35c57290d3aac32d36e0",measurementId:"G-8HGXFZXEQT"}),h.a.analytics();var j=h.a,p=h.a.firestore(),f={happy:["leftEye","rightEye","mouth"],angry:["leftEye","rightEye","mouth"],naki:["leftEye","rightEye","mouth"],yurei:["leftEye","rightEye","mouth"],thinking:["leftEye","rightEye","mouth"],henoheno:["leftEye","rightEye","mouth","nose","face"]},b=function(e){var t=function(t){var n,s,i=t.info;return"null"!==e.emotion&&e.emotion&&-1!==f[e.emotion].indexOf(i[0])?(n="../images/icon/"+e.emotion+"_"+i[0]+".png",s=0):(n="../images/icon/"+i[1].kind+"_"+i[0]+".png",s=parseInt(i[1].rot)),Object(o.jsx)("img",{className:e.where+"-iconparts "+i[0],src:n,style:{height:i[1].sizeY/300*e.iconSize+"px",width:i[1].sizeX/300*e.iconSize+"px",top:i[1].posY/300*e.iconSize+"px",left:i[1].posX/300*e.iconSize+"px",position:"absolute",transform:"rotate("+s+"deg)"}},i[0])};return Object(o.jsx)("div",{className:e.where+"-icon",style:{position:"relative",height:e.iconSize+"px",width:e.iconSize+"px"},children:Object.entries(e.iconInfo).map((function(e){return Object(o.jsx)(t,{info:e},e[0])}))})};n(56);var x=function(){var e=Object(s.useContext)(de),t=e.isOnline,n=e.userId,i=e.userInfo,c=Object(s.useState)(null),r=Object(u.a)(c,2),a=r[0],l=r[1],d=Object(s.useState)(null),m=Object(u.a)(d,2),h=m[0],f=m[1];return Object(s.useEffect)((function(){i&&(i.room&&p.collection("rooms").doc(i.room).get().then((function(e){e.exists?f([e.id,e.data().roomName]):p.collection("users").doc(n).update({room:null})})),0!==i.rooms.length?p.collection("rooms").where(j.firestore.FieldPath.documentId(),"in",i.rooms).get().then((function(e){var t={},o=[];e.empty?(l(!1),p.collection("users").doc(n).update({rooms:[]})):(e.docs.forEach((function(e){e.exists&&(t[e.id]=e.data().roomName,o.push(e.id))})),l(t),o.length!==i.rooms.length&&p.collection("users").doc(n).update({rooms:o}))})).catch((function(e){console.log("Error:"+e)})):l(!1))}),[i]),Object(o.jsx)("nav",{className:"navbar navbar-default",style:{margin:"0px"},children:Object(o.jsxs)("div",{className:"container-fluid",children:[Object(o.jsxs)("div",{className:"navbar-header",children:[Object(o.jsxs)("button",{type:"button",className:"navbar-toggle collapsed","data-toggle":"collapse","data-target":"#bs-example-navbar-collapse-1",children:[Object(o.jsx)("span",{className:"sr-only",children:"Toggle navigation"}),Object(o.jsx)("span",{className:"icon-bar"}),Object(o.jsx)("span",{className:"icon-bar"}),Object(o.jsx)("span",{className:"icon-bar"})]}),Object(o.jsx)("a",{className:"navbar-brand",href:"/",children:"\u30a8\u30e2\u3044\u30c1\u30e3\u30c3\u30c8\u3002"})]}),Object(o.jsxs)("div",{className:"collapse navbar-collapse",id:"bs-example-navbar-collapse-1",children:[Object(o.jsxs)("ul",{className:"nav navbar-nav",children:[Object(o.jsx)("li",{className:"",children:Object(o.jsxs)("a",{href:"/",children:["\u30db\u30fc\u30e0",Object(o.jsx)("span",{className:"sr-only",children:"(current)"})]})}),null!==h&&Object(o.jsx)("li",{className:"",children:Object(o.jsxs)("a",{href:"/room/"+h[0],children:[h[1],Object(o.jsx)("span",{className:"sr-only",children:"(current)"})]})}),Object(o.jsxs)("li",{className:"dropdown",children:[Object(o.jsxs)("a",{className:"dropdown-toggle","data-toggle":"dropdown",role:"button","aria-expanded":"false",children:["\u30eb\u30fc\u30e0s ",Object(o.jsx)("span",{className:"caret"})]}),Object(o.jsxs)("ul",{className:"dropdown-menu",role:"menu",children:[!1===a&&Object(o.jsx)("li",{children:Object(o.jsx)("p",{children:"no rooms"})}),!1===t&&Object(o.jsx)("li",{children:Object(o.jsx)("p",{children:"not loggedIn"})}),null!==a&&!1!==a&&Object.entries(a).map((function(e){return Object(o.jsx)("li",{children:Object(o.jsx)("a",{href:"/room/"+e[0],children:e[1]})},e[0])}))]})]})]}),!0===t&&Object(o.jsx)("ul",{className:"nav navbar-nav navbar-right",children:Object(o.jsxs)("li",{id:"userInfo-li",href:"/userSetting",children:[Object(o.jsx)("a",{id:"infoLink-icon",href:"/userSetting"}),Object(o.jsxs)("div",{href:"/userSetting",className:"iconMask barMask",children:[null!==i&&Object(o.jsx)(b,{iconInfo:i.iconinfo,where:"header",iconSize:"50"}),Object(o.jsx)("h6",{id:"icon-loading-text",children:"loading icon..."})]})]})})]})]})})},O=(n(24),n(74),n(75),n(29),function(e){var t=Object(s.useContext)(X).reActions,n=Object(s.useContext)(K).members;function i(e){return Math.floor(Math.random()*Math.floor(e))-e/2}return Object(o.jsxs)("div",{id:"",className:"reActions icon-acce",children:[console.log(e.renderId,t),t[e.renderId].map((function(e){return Object(o.jsxs)("div",{className:"reaction",style:{top:-150+i(100),left:i(100)},children:[Object(o.jsx)("img",{src:"../../../../../images/reactions/"+e.name+".png",className:"reactionImg"}),n[e.from].displayName.length>9&&Object(o.jsx)("h4",{className:"reaction-from",children:n[e.from].displayName.substr(0,9)+"..."}),n[e.from].displayName.length<=9&&Object(o.jsx)("h4",{className:"reaction-from",children:n[e.from].displayName})]},e.id)}))]})}),g=function(e){var t=Object(s.useContext)(X).newComment;return Object(o.jsx)("div",{className:"balloon1 icon-acce top",children:Object(o.jsx)("div",{className:"balloon1-text",children:Object(o.jsx)("p",{children:t[e.renderId]})})},e.renderId)},v=function(e){var t=Object(s.useContext)(K).room,n=Object(s.useContext)(de).userId,i=function(e){var o=e.target.dataset.name,s=e.target.dataset.user;console.log(o,s),p.collection("rooms").doc(t.id).collection("reActions").add({name:o,from:n,to:s,timeStamp:j.firestore.FieldValue.serverTimestamp()}).then((function(e){setTimeout((function(){p.collection("rooms").doc(t.id).collection("reActions").doc(e.id).delete()}),3e3)})).catch((function(e){console.log(e)}))};return Object(o.jsxs)("div",{className:"icon-acce reActionbuttons",children:[Object(o.jsx)("button",{className:"reActionButton",onClick:i,"data-name":"good","data-user":e.renderId,children:"good"}),Object(o.jsx)("button",{className:"reActionButton",onClick:i,"data-name":"kusa","data-user":e.renderId,children:"\u8349"}),Object(o.jsx)("button",{className:"reActionButton",onClick:i,"data-name":"question","data-user":e.renderId,children:"\uff1f"})]})},y=function(e){var t=Object(s.useContext)(de).userId,n=Object(s.useContext)(X),i=n.emotions,c=n.reActions,r=n.newComment;return Object(o.jsxs)("div",{className:"stageIcon",children:[console.log(e.renderInfo),e.renderInfo[0]!==t&&Object(o.jsx)("h3",{className:"stageIcon-displayName icon-acce",children:e.renderInfo[1].displayName}),e.renderInfo[0]===t&&Object(o.jsx)("h3",{className:"self-mark stageIcon-displayName icon-acce",children:e.renderInfo[1].displayName}),null===r&&Object(o.jsx)("p",{className:"icon-acce",children:"Loading NewComment..."}),null!==r&&r[e.renderInfo[0]]&&Object(o.jsx)(g,{renderId:e.renderInfo[0]}),Object(o.jsx)(b,{iconInfo:e.renderInfo[1].iconInfo,iconSize:200,emotion:i[e.renderInfo[0]],where:"stage"}),e.renderInfo[0]!==t&&Object(o.jsx)(v,{renderId:e.renderInfo[0]}),null===c&&Object(o.jsx)("p",{className:"icon-acce",children:"Loading Actions..."}),null!==c&&c[e.renderInfo[0]]&&Object(o.jsx)(O,{renderId:e.renderInfo[0]})]})};var I=function(e){var t=Object(s.useContext)(K),n=t.members,i=t.room;return Object(o.jsxs)("div",{id:"nomal",children:[console.log(Object.keys(n),i,n,i.members,i.members,i.members[0],n[i.members[0]]),Object.keys(n).map((function(e,t){return Object(o.jsx)("div",{className:"icondiv",children:Object(o.jsx)(y,{renderInfo:[i.members[t],n[i.members[t]]]})},"icondiv"+t)}))]})},z=function(){var e,t=Object(s.useContext)(K).room,n=Object(s.useContext)(X),i=n.emotions,c=(n.setEmotions,Object(s.useContext)(de)),r=c.userId,a=c.userInfo;function l(){var n=document.getElementById("inputComment").value;if(n.length>0&&n.length<=300){document.getElementById("inputComment").value="";var o,s=t.id;o=i[r]?i[r]:null,p.collection("rooms").doc(s).collection("comments").add({content:n,userId:r,userName:a.displayName,emotion:o,timeStamp:j.firestore.FieldValue.serverTimestamp()}),p.collection("rooms").doc(t.id).collection("newComment").doc(r).set({content:n,timeStamp:j.firestore.FieldValue.serverTimestamp()}).then((function(){console.log(e,"newComment Timer"),e&&(clearTimeout(e),console.log("newComment Timer Cleared!",e)),e=setTimeout((function(){p.collection("rooms").doc(t.id).collection("newComment").doc(r).delete()}),6e3),console.log(e+"newComment Timer")}))}}Object(s.useEffect)((function(){document.body.addEventListener("keydown",(function(e){"Enter"===e.key&&e.ctrlKey&&l()}))}),[]);var d=function(e){var n=e.target.dataset.kind;console.log(n),null===n?p.collection.doc(t.id).collection("emotions").doc(r).delete():p.collection("rooms").doc(t.id).collection("emotions").doc(r).set({kind:n,timeStamp:j.firestore.FieldValue.serverTimestamp()})};return Object(o.jsxs)("div",{id:"commentForm",children:[Object(o.jsxs)("div",{id:"emotions",children:[Object(o.jsx)("button",{className:"emotoButton",onClick:d,"data-kind":"henoheno",children:"\u3078\u306e\u3078\u306e"}),Object(o.jsx)("button",{className:"emotoButton",onClick:d,"data-kind":"null",children:"\u306a\u3057"}),Object(o.jsx)("button",{className:"emotoButton",onClick:d,"data-kind":"yurei",children:"\u30e6\u30fc\u30ec\u30a4"}),Object(o.jsx)("button",{className:"emotoButton",onClick:d,"data-kind":"happy",children:"\u30cb\u30b3\u30cb\u30b3"}),Object(o.jsx)("button",{className:"emotoButton",onClick:d,"data-kind":"angry",children:"\u6012\u308a"}),Object(o.jsx)("button",{className:"emotoButton",onClick:d,"data-kind":"naki",children:"\u6ce3\u304d"})]}),Object(o.jsxs)("div",{className:"form",children:[Object(o.jsx)("input",{id:"inputComment"}),Object(o.jsx)("button",{type:"submit",maxLength:"300",onClick:l,children:"\u6295\u7a3f"})]})]})},N=n(23);function k(e){return Math.floor(Math.random()*Math.floor(e))-e/2}var E=function(e,t){return setInterval((function(){!function(e,t,n){var o=window.getComputedStyle(e,null).getPropertyValue("transform").substr(7).split(",").slice(0,4);e.style.transform="matrix("+o[0]+","+o[1]+","+o[2]+","+o[3]+","+k(t)+","+k(n)+")"}(e,5,5)}),t)};var X=Object(s.createContext)([]),Y=function(e){Object(s.useContext)(de).userId;var t=Object(s.useContext)(K),n=(t.icons,t.splitSize,t.room),i=Object(s.useState)(null),c=Object(u.a)(i,2),r=c[0],a=c[1],m=Object(s.useState)({}),h=Object(u.a)(m,2),j=h[0],f=h[1],b=Object(s.useState)({}),x=Object(u.a)(b,2),O=x[0],g=x[1],v=n.id;return Object(s.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,n=new Date(t.getTime()-5e3),console.log(n,t),e.next=5,p.collection("/rooms").doc(v).collection("emotions").where("timeStamp",">",n).onSnapshot((function(e){console.log(e);var t=[],n=e.docs.map((function(e){return e.id}));e.forEach((function(e){t.push(e.data())}));for(var o={},s=0;s<n.length;s++)o[n[s]]=t[s].kind;console.log(e,t,o,"\u3093"),f(o)}));case 5:return o=e.sent,e.abrupt("return",(function(){return o()}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(d.a)(l.a.mark((function e(){var t,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,n=new Date(t.getTime()-6e3),e.next=4,p.collection("/rooms").doc(v).collection("newComment").where("timeStamp",">",n).onSnapshot((function(e){var t=[],n=e.docs.map((function(e){return e.id}));e.forEach((function(e){t.push(e.data())}));for(var o={},s=0;s<n.length;s++)o[n[s]]=t[s].content;console.log(e,t,o,"\u3093"),a(o)}));case 4:return o=e.sent,e.abrupt("return",(function(){return o()}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function n(){return(n=Object(d.a)(l.a.mark((function e(){var t,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,n=new Date(t.getTime()-5e3),console.log(n,t),e.next=5,p.collection("/rooms").doc(v).collection("reActions").where("timeStamp",">",n).onSnapshot((function(e){var t=[],n=e.docs.map((function(e){return e.id}));e.forEach((function(e){t.push(e.data())}));for(var o={},s=0;s<n.length;s++)o[t[s].to]||(o[t[s].to]=[]),o[t[s].to].push({id:n[s],name:t[s].name,from:t[s].from,to:t[s].to});console.log(e,t,o,"\u3093"),g(o)}));case 5:return o=e.sent,e.abrupt("return",(function(){return o()}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}(),function(){n.apply(this,arguments)}()}),[]),Object(s.useEffect)((function(){var e=function(){for(var e=[],t=0;t<e.length;t++)clearInterval(e[t]);e=[];for(var n=document.getElementsByClassName("stage-iconparts"),o=0;o<n.length;o++)e.push(E(n[o],1e3));return e}();return function(){e.forEach((function(e){clearInterval(e)}))}})),Object(o.jsx)(X.Provider,{value:{newComment:r,setNewComment:a,emotions:j,setEmotions:f,reActions:O,setActions:g},children:Object(o.jsxs)(N.a,{split:"horizontal",defaultSize:window.innerHeight-171,children:[Object(o.jsx)("div",{id:"stage",children:Object(o.jsx)(I,{stageRadius:600})}),Object(o.jsx)(z,{})]})})};n(79),n(80),n(81);function w(e,t){return C.apply(this,arguments)}function C(){return(C=Object(d.a)(l.a.mark((function e(t,n){var o,s,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.collection("rooms").doc(t).collection(n).get();case 2:return(o=e.sent).empty||(s=0,i=0,(c=[]).push(p.batch()),o.docs.forEach((function(e){c[s].delete(e.ref),499===++i&&(c.push(p.batch()),s++,i=0)})),c.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.commit();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=function(){var e=Object(s.useContext)(K).room,t=Object(s.useContext)(de).userId;return Object(o.jsxs)("header",{id:"room-header",children:[Object(o.jsx)("div",{id:"room-name",children:Object(o.jsx)("strong",{children:e.roomName})}),Object(o.jsxs)("ul",{id:"room-info",children:[Object(o.jsxs)("li",{children:["\u53c2\u52a0\u8005\uff1a",e.members.length]}),Object(o.jsxs)("li",{children:[" \u4f5c\u6210\u8005\uff1a",e.madeUserName]}),Object(o.jsxs)("li",{children:[" \u4f5c\u6210\u65e5\u6642\uff1a",e.madeTime]}),Object(o.jsxs)("li",{children:[" \u30e1\u30f3\u30d0\u30fc\uff1a",e.members.length,"\u4eba"]})]}),console.log(e,e.madeUserId,t),e.madeUserId===t&&Object(o.jsx)("button",{id:"room-delete",onClick:function(){if(window.confirm("\u3053\u306e\u64cd\u4f5c\u306f\u53d6\u308a\u6d88\u305b\u307e\u305b\u3093\u3001\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")){var t=p.collection("/rooms").doc(e.id),n=e.id;t&&w(n,"newComment").then((function(){w(n,"emotions").then((function(){w(n,"reActions").then((function(){w(n,"comments").then((function(){t.delete().then((function(){}))}))}))}))})).catch((function(e){console.log("Error:"+e)}))}},children:"\u30eb\u30fc\u30e0\u3092\u524a\u9664"})]})},B=(n(82),n(45)),K=Object(s.createContext)([]),L=function(){var e=Object(s.useState)(null),t=Object(u.a)(e,2),n=t[0],i=t[1],c=Object(s.useState)(null),r=Object(u.a)(c,2),a=r[0],m=r[1],h=Object(s.useState)(null),f=Object(u.a)(h,2),b=f[0],x=f[1],O=Object(s.useState)(800),g=Object(u.a)(O,2),v=g[0],y=g[1],I=Object(s.useState)(null),z=Object(u.a)(I,2),k=z[0],E=z[1],X=Object(s.useContext)(de),w=(X.isOnline,X.userId),C=(X.userInfo,window.location.pathname.split("/")[2]);return Object(s.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.collection("/rooms").doc(C).onSnapshot((function(e){if(e.exists){var t=e.data();-1===t.members.indexOf(w)?(console.log("\u5165\u5ba4\u3057\u307e\u3057\u305f"),p.collection("rooms").doc(C).update({members:j.firestore.FieldValue.arrayUnion(w)}).then((function(){p.collection("users").doc(w).update({rooms:j.firestore.FieldValue.arrayUnion(C)}).catch((function(e){console.log("Error:"+e)})).then((function(){m(!0)})),p.collection("users").doc(w).update({room:C}).catch((function(e){console.log("Error:"+e)}))})).catch((function(e){console.log("Error:"+e)}))):m(!0);var n=t.timeStamp.toDate(),o={id:e.id,roomName:t.roomName,stageId:t.stageId,madeTime:n.getFullYear()+"/"+n.getMonth()+"1/"+n.getDate(),madeUserId:t.madeUserId,madeUserName:t.madeUserName,members:t.members};i(o)}else m(!1)}));case 2:return t=e.sent,e.abrupt("return",(function(){return t()}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(s.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=6;break}return console.log(n),e.next=4,p.collection("/rooms").doc(C).collection("comments").orderBy("timeStamp","asc").onSnapshot((function(e){var t=e.docs.map((function(e){return e.id})),n=[];e.forEach((function(e){n.push(e.data())}));for(var o=[],s=0;s<t.length;s++)o.push({id:t[s],content:n[s].content,emotion:n[s].emotion,userId:n[s].userId});console.log(t,o,e),x(o)}));case 4:return t=e.sent,e.abrupt("return",(function(){return t()}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=6;break}return t={},e.next=4,p.collection("rooms").doc(C).onSnapshot(function(){var e=Object(d.a)(l.a.mark((function e(n){var o,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.data().members,console.log(o),!o||0===o.length){e.next=10;break}s=l.a.mark((function e(n){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=o.slice(10*n,10*n+10),e.next=3,p.collection("users").where("userId","in",s).get().then((function(e){e.empty||(console.log(e),e.docs.forEach((function(e){var n=e.data(),o=e.data().userId;t[o]={displayName:n.displayName,oneWord:n.oneWord,iconInfo:n.iconinfo}})),console.log(t,e,e.docs),console.log("member",Math.floor(o.length/10)+1,n),n+1>=Math.floor(o.length/10)+1&&(console.log("member load fin:"+t,t.length),E(t)))}));case 3:case"end":return e.stop()}}),e)})),i=0;case 5:if(!(i<Math.floor(o.length/10)+1)){e.next=10;break}return e.delegateYield(s(i),"t0",7);case 7:i++,e.next=5;break;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:return n=e.sent,e.abrupt("return",(function(){return n()}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[a]),Object(o.jsxs)("div",{className:"container",children:[null===a&&Object(o.jsx)("p",{children:"Loading Room..."}),!0===a&&Object(o.jsxs)(K.Provider,{value:{members:k,setMembers:E,room:n,setRoom:i,comments:b,setComments:x,splitSize:v,setSplitSize:y},children:[null===n&&Object(o.jsx)("p",{children:"Loading Room..."}),n&&Object(o.jsxs)("div",{className:"row",children:[Object(o.jsx)(S,{}),Object(o.jsxs)(N.a,{split:"vertical",minSize:300,defaultSize:800,maxSize:1e3,style:{height:window.innerHeight-101},children:[Object(o.jsxs)("div",{id:"left",style:{display:"flex"},children:[null===k&&Object(o.jsx)("p",{children:"Loading Stage..."}),null!==k&&Object(o.jsx)(Y,{})]}),Object(o.jsxs)("div",{id:"right",children:[null===b&&null!==k&&Object(o.jsx)("p",{children:"Loading Ccomments..."}),null!==b&&null!==k&&Object(o.jsx)(M,{})]})]})]})]}),0==a&&Object(o.jsx)(B.Redirect,{to:"/error"})]})},M=(n(85),function(){var e=Object(s.useContext)(K),t=e.comments,n=(e.room,e.members);window.location.pathname;return Object(s.useEffect)((function(){var e=document.getElementById("scroll-inner");console.log(e),e.scrollIntoView(!1);var t=function(){for(var e=[],t=0;t<e.length;t++)clearInterval(e[t]);e=[];for(var n=document.getElementsByClassName("comments-iconparts"),o=0;o<n.length;o++)e.push(E(n[o],1e3));return e}();return function(){t.forEach((function(e){clearInterval(e)}))}})),Object(o.jsx)("div",{id:"comments",className:"list-group",children:Object(o.jsx)("div",{id:"scroll-inner",children:t&&n&&t.map((function(e){return Object(o.jsxs)("div",{className:"comment list-group-item d-flex",children:[Object(o.jsx)("div",{className:"iconMask commentIcon",children:Object(o.jsx)(b,{iconInfo:n[e.userId].iconInfo,iconSize:50,emotion:e.emotion,where:"comments"})}),Object(o.jsxs)("div",{children:[console.log(n),Object(o.jsx)("strong",{className:"userName mb-1",style:{},children:n[e.userId].displayName}),Object(o.jsx)("h3",{className:"commentContent",style:{},children:e.content})]})]},e.id.toString())}))})})}),T=(n(44),[{face:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"nomal"},hair:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"nomal"},leftEye:{posX:90,posY:150,sizeX:50,sizeY:50,rot:0,kind:"nomal"},rightEye:{posX:160,posY:150,sizeX:50,sizeY:50,rot:0,kind:"nomal"},nose:{posX:120,posY:180,sizeX:50,sizeY:50,rot:0,kind:"nomal"},mouth:{posX:120,posY:210,sizeX:50,sizeY:50,rot:0,kind:"nomal"},other:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"none"}},{face:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"henoheno"},hair:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"none"},leftEye:{posX:90,posY:150,sizeX:50,sizeY:50,rot:0,kind:"henoheno"},rightEye:{posX:160,posY:150,sizeX:50,sizeY:50,rot:0,kind:"henoheno"},nose:{posX:120,posY:180,sizeX:50,sizeY:50,rot:0,kind:"henoheno"},mouth:{posX:120,posY:210,sizeX:50,sizeY:50,rot:0,kind:"henoheno"},other:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"henoheno"}},{face:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"maru"},hair:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"cat"},leftEye:{posX:90,posY:150,sizeX:50,sizeY:50,rot:0,kind:"cat"},rightEye:{posX:160,posY:150,sizeX:50,sizeY:50,rot:0,kind:"cat"},nose:{posX:120,posY:180,sizeX:50,sizeY:50,rot:0,kind:"cat"},mouth:{posX:120,posY:210,sizeX:50,sizeY:50,rot:0,kind:"cat"},other:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"hige"}},{face:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"komugi"},hair:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"kaku"},leftEye:{posX:90,posY:150,sizeX:50,sizeY:50,rot:0,kind:"red"},rightEye:{posX:160,posY:150,sizeX:50,sizeY:50,rot:0,kind:"blue"},nose:{posX:120,posY:180,sizeX:50,sizeY:50,rot:0,kind:"pig"},mouth:{posX:120,posY:210,sizeX:50,sizeY:50,rot:0,kind:"fang"},other:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"horns"}},{face:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"monster"},hair:{posX:0,posY:0,sizeX:300,sizeY:290,rot:0,kind:"tyuni"},leftEye:{posX:90,posY:150,sizeX:50,sizeY:50,rot:0,kind:"tyome"},rightEye:{posX:160,posY:150,sizeX:50,sizeY:50,rot:0,kind:"tyome"},nose:{posX:120,posY:180,sizeX:50,sizeY:50,rot:0,kind:"hole"},mouth:{posX:120,posY:210,sizeX:50,sizeY:50,rot:0,kind:"tooth"},other:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"glasses"}}]);function U(){return T[Math.floor(Math.random()*Math.floor(T.length))]}var A={face:{displayName:"\u9854",Kinds:{henoheno:{displayKind:"\u3058"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},monster:{displayKind:"\u5316\u7269"},komugi:{displayKind:"\u5c0f\u9ea6\u8272"},maru:{displayKind:"\u307e\u308b"}}},hair:{displayName:"\u9aea",Kinds:{none:{displayKind:"\u306a\u3057"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},cat:{displayKind:"\u30b1\u30e2\u30df\u30df"},tyuni:{displayKind:"\u53a8\u4e8c"},kaku:{displayKind:"\u30ab\u30af\u30ac\u30ea"}}},leftEye:{displayName:"\u5de6\u76ee",Kinds:{henoheno:{displayKind:"\u3078\u306e"},no:{displayKind:"\u306e"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},cat:{displayKind:"\u306d\u3053"},red:{displayKind:"\u7d05"},blue:{displayKind:"\u84bc"},tyome:{displayKind:"\u30b3\u30e1"}}},rightEye:{displayName:"\u53f3\u76ee",Kinds:{henoheno:{displayKind:"\u3078\u306e"},no:{displayKind:"\u306e"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},cat:{displayKind:"\u306d\u3053"},red:{displayKind:"\u7d05"},blue:{displayKind:"\u84bc"},tyome:{displayKind:"\u30b3\u30e1"}}},nose:{displayName:"\u9f3b",Kinds:{henoheno:{displayKind:"\u3082"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},cat:{displayKind:"\u9006\u4e09\u89d2"},pig:{displayKind:"\u3076\u305f\u3063\u3071\u306a"}}},mouth:{displayName:"\u53e3",Kinds:{henoheno:{displayKind:"\u3078"},nomal:{displayKind:"\u30d5\u30c4\u30fc"},cat:{displayKind:"\u30c0\u30d6\u30ea\u30e5\u30fc"},fang:{displayKind:"\u7259"},tooth:{displayKind:"\u6b6f"}}},other:{displayName:"\u305d\u306e\u4ed6",Kinds:{none:{displayKind:"\u306a\u3057"},horns:{displayKind:"\u30c4\u30ce"},glasses:{displayKind:"\u3081\u304c\u306d"},henoheno:{displayKind:"\u3078\u306e\u3078\u306e"}}}};var F={face:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"nomal"},hair:{posX:0,posY:0,sizeX:300,sizeY:300,rot:0,kind:"nomal"},leftEye:{posX:0,posY:0,sizeX:50,sizeY:50,rot:0,kind:"nomal"},rightEye:{posX:0,posY:0,sizeX:50,sizeY:50,rot:0,kind:"nomal"},nose:{posX:0,posY:0,sizeX:50,sizeY:50,rot:0,kind:"nomal"},mouth:{posX:0,posY:0,sizeX:50,sizeY:50,rot:0,kind:"nomal"},other:{posX:0,posY:0,sizeX:50,sizeY:50,rot:0,kind:"nomal"}};function R(e,t){return F[e][t]}var V={face:{max:350,min:200},hair:{max:350,min:200},leftEye:{max:70,min:15},rightEye:{max:70,min:15},mouth:{max:100,min:15},nose:{max:100,min:15},other:{max:400,min:30}};function D(e){return V[e].max}function P(e){return V[e].min}var W={face:{sizeX:300,sizeY:300},hair:{sizeX:300,sizeY:300},leftEye:{sizeX:30,sizeY:30},rightEye:{sizeX:30,sizeY:30},mouth:{sizeX:40,sizeY:40},nose:{sizeX:40,sizeY:40},other:{sizeX:300,sizeY:300}};function G(e,t,n){W[e]={sizeX:t,sizeY:n}}var _={face:{max:360,min:0},hair:{max:360,min:0},leftEye:{max:360,min:0},rightEye:{max:360,min:0},mouth:{max:360,min:0},nose:{max:360,min:0},other:{max:360,min:0}};function H(e){return _[e].max}function J(e){return _[e].min}var Z={face:0,hair:0,leftEye:0,rightEye:0,mouth:0,nose:0,other:0};function q(e,t){console.log(t),Z[e]=t}n(86);var Q=function(){var e,t=Object(s.useContext)(ee),n=t.setNowKind,i=(t.nowKind,t.nowName);return Object(o.jsxs)("div",{id:"makeIconButtons",className:i+"button",children:[console.log(i),Object.entries((e=i,console.log(e),A[e].Kinds)).map((function(e){return Object(o.jsx)("button",{className:e[0]+" "+i+" iconKindButton btn-text-3d","data-name":i,"data-kind":e[0],onClick:function(e){n(e.target.dataset.kind),document.getElementsByClassName("iconKindButton").forEach((function(e){e.classList.contains("active")&&e.classList.remove("active")})),e.target.classList.add("active")},children:e[1].displayKind},e[0])}))]})},$="./images/icon/",ee=Object(s.createContext)([]),te=function(){var e=Object(s.useState)(null),t=Object(u.a)(e,2),n=t[0],i=t[1],c=Object(s.useState)("face"),r=Object(u.a)(c,2),a=r[0],l=r[1],d=Object(s.useState)(30),m=Object(u.a)(d,2),h=m[0],j=m[1],p=Object(s.useState)(0),f=Object(u.a)(p,2),b=f[0],x=f[1],O=Object(s.useContext)(de).userInfo;Object(s.useEffect)((function(){var e;O&&(e=O.iconinfo,F=e,Object.entries(O.iconinfo).forEach((function(e){G(e[0],e[1].sizeX,e[1].sizeY),q(e[0],e[1].rot);var t=document.getElementById(e[0]+"Img");t||((t=document.createElement("img")).classList.add("set-image"),t.classList.add(e[0]),t.id=e[0]+"Img"),v(t,e[1].sizeX,e[1].sizeY,e[1].posX,e[1].posY,e[1].rot,e[1].kind,e[0])})));var t=R(a,"kind");document.getElementsByClassName("iconNameButton").forEach((function(e){console.log(e),e.classList.contains(a)&&e.classList.add("active")})),document.getElementsByClassName("iconKindButton").forEach((function(e){e.classList.contains(t)&&e.classList.add("active")})),i(R(a,"kind"))}),[O]),Object(s.useEffect)((function(){var e=R(a,"kind");document.getElementsByClassName("iconKindButton").forEach((function(t){t.classList.contains("active")&&t.classList.remove("active"),t.classList.contains(e)&&t.classList.add("active")})),i(e)}),[a]);var g,v=function(e,t,n,o,s,i,c,r){e.src=$+c+"_"+r+".png",e.style.width=t+"px",e.style.height=n+"px",e.style.position="absolute",e.style.left=o+"px",e.style.top=s+"px",e.style.transform="rotate("+i+"deg)";var a={posX:o,posY:s,sizeX:t,sizeY:n,rot:i,kind:c};document.getElementById("icon-space").appendChild(e),function(e,t){F[e]=t}(r,a)};var y,I=function(e){e||(e=a);var t,n=document.getElementById("rotInput"),o=n.value,s=H(e),i=J(e);q(e,t=s<o?s:i>o?i:o),x(t),n.value=t},z=function(e){e||(e=a);var t,n=document.getElementById("sizeInput"),o=n.value,s=D(e),i=P(e);G(e,t=s<o?s:i>o?i:o,t),j(t),n.value=t};Object(s.useContext)(de).userId;return Object(o.jsxs)("div",{id:"makeIcon",children:[null===O&&Object(o.jsx)("p",{children:"loading infos..."}),null!==O&&Object(o.jsxs)(ee.Provider,{value:{nowKind:n,setNowKind:i,nowName:a,setNowName:l,nowSize:h,setNowSize:j,nowRot:b,setNowRot:x},children:[Object(o.jsx)("div",{id:"icon-space",className:"iconMask",onMouseMove:function(e){var t=e.clientX-Math.floor(h/2),n=e.clientY-Math.floor(h/2);document.getElementById("traceImage").style.top=n+"px",document.getElementById("traceImage").style.left=t+"px"},onMouseLeave:function(){document.getElementById("traceImage").style.display="none"},onMouseEnter:function(){document.getElementById("traceImage").style.display="block"},onClick:function(e){z(),I();var t=document.getElementById(a+"Img");t||((t=document.createElement("img")).classList.add("set-image"),t.classList.add(a+"Img"),t.id=a);var o=document.getElementById("icon-space").getBoundingClientRect(),s=window.pageXOffset+o.left,i=window.pageYOffset+o.top,c=e.clientX,r=e.clientY,l=c-s-Math.floor(document.getElementById("sizeInput").value/2),d=r-i-Math.floor(document.getElementById("sizeInput").value/2);v(t,document.getElementById("sizeInput").value,document.getElementById("sizeInput").value,l,d,document.getElementById("rotInput").value,n,a),document.getElementById("save-button").classList.add("active")}}),console.log($+n+a+"png"),Object(o.jsx)("img",{id:"traceImage",src:$+n+"_"+a+".png",style:{height:h+"px",width:h+"px",zIndex:"100",position:"absolute",display:"none",cursor:"none",pointerEvents:"none",transform:"rotate("+b+"deg)"}}),Object(o.jsxs)("div",{children:["\u56de\u8ee2",Object(o.jsx)("input",{type:"number",id:"rotInput",onInput:function(e){y&&clearTimeout(y),y=setTimeout(I,1e3)},min:J(a),max:H(a),defaultValue:"0"}),"\u30b5\u30a4\u30ba",Object(o.jsx)("input",{type:"number",id:"sizeInput",onInput:function(e){g&&clearTimeout(g),g=setTimeout(z,1e3)},min:P(a),max:D(a),defaultValue:"30"})]}),Object(o.jsx)("div",{id:"name-buttons",className:"",children:Object.entries(A).map((function(e){return Object(o.jsx)("button",{id:e[0]+"IconNameButton",className:e[0]+" iconNameButton btn-border_buttom","data-name":e[0],onClick:function(e){var t;document.getElementsByClassName("iconNameButton").forEach((function(e){e.classList.contains("active")&&e.classList.remove("active")})),l(e.target.dataset.name),i(R(e.target.dataset.name,"kind")),document.getElementById("sizeInput").value=(t=e.target.dataset.name,console.log(t,W[t].sizeX),W[t].sizeX),document.getElementById("rotInput").value=function(e){return Z[e]}(e.target.dataset.name),z(e.target.dataset.name),I(e.target.dataset.name)},children:e[1].displayName},e[0])}))}),Object(o.jsx)(Q,{})]})]})},ne=function(){var e=Object(s.useContext)(de),t=e.setUserId,n=(e.setUserName,e.setIsOnline),i=e.isOnline,c=function(){j.auth().signOut(),n(!1),t(null)};return Object(o.jsxs)("div",{children:[!0===i&&Object(o.jsxs)("div",{children:["\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3057\u305f\uff01",Object(o.jsx)(m.Redirect,{to:"/userSetting"})]}),!1===i&&Object(o.jsxs)("div",{children:["\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u305b\u3093",Object(o.jsx)("button",{onClick:function(){ue=!0,j.auth().setPersistence(j.auth.Auth.Persistence.LOCAL).then(function(){var e=new j.auth.GoogleAuthProvider;j.auth().signInWithPopup(e).then(function(){var e=Object(d.a)(l.a.mark((function e(o){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.collection("/users").where("userId","==",o.user.uid).get().then((function(e){console.log(e),e.empty?(console.log("No user"),p.collection("users").doc(o.user.uid).set({userId:o.user.uid,displayName:"\u30b2\u30b9\u30c8",oneWord:"",room:null,rooms:[],iconinfo:U()}).then(function(){var e=Object(d.a)(l.a.mark((function e(s){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.collection("users").doc(o.user.uid).collection("seclet").doc(o.user.uid).set({userName:o.user.displayName,email:o.user.email}).then((function(){console.log("login fin"),n(!0),t(o.user.uid)})).catch((function(e){p.collection("users").doc(o.user.uid).delete().then((function(){c(),alert("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3001\u3082\u3046\u4e00\u5ea6\u30ed\u30b0\u30a4\u30f3\u3092\u304a\u9858\u3044\u3057\u307e\u3059\u3002Error:"+e),console.log(e)}))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){c(),alert("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3001\u3082\u3046\u4e00\u5ea6\u30ed\u30b0\u30a4\u30f3\u3092\u304a\u9858\u3044\u3057\u307e\u3059\u3002Error:"+e),console.log(e)}))):(n(!0),t(o.user.uid))})).catch((function(e){console.log("Error : ",e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}().bind(this)).catch((function(e){return alert("Google\u3067\u30b5\u30a4\u30f3\u30a4\u30f3\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 Error: ",e),console.log(e),!1}))}.bind(undefined))},children:"Google\u3067\u30ed\u30b0\u30a4\u30f3"})]}),null===i&&Object(o.jsx)(o.Fragment,{children:"loading aouth..."})]})},oe=(n(89),function(){var e=Object(s.useContext)(de),t=e.setIsOnline,n=(e.isOnline,e.setUserId),i=e.userId,c=e.userInfo,r=function(){j.auth().signOut(),t(!1),n(null),document.location.reload()};return Object(o.jsxs)("div",{children:[null===c&&Object(o.jsx)("p",{children:"Loading userInfo..."}),c&&Object(o.jsxs)("div",{children:[Object(o.jsxs)("ul",{children:[Object(o.jsxs)("li",{children:[Object(o.jsx)("h4",{children:"\u8868\u793a\u540d"}),Object(o.jsx)("input",{id:"displayName-input",type:"text",maxLength:"15",defaultValue:c.displayName,onChange:function(){document.getElementById("save-button").classList.add("active")}})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("h4",{children:"\u3072\u3068\u3053\u3068"}),Object(o.jsx)("h3",{children:Object(o.jsx)("input",{id:"oneWord-input",type:"text",maxLength:"30",defaultValue:c.oneWord,onChange:function(){document.getElementById("save-button").classList.add("active")}})})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("h4",{children:"\u540d\u524d"}),Object(o.jsx)("h3",{children:c.userName})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("h4",{children:"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9"}),Object(o.jsx)("h3",{children:c.email})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("h4",{children:"Google\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u3059"}),Object(o.jsx)("button",{onClick:r,children:"\u30ed\u30b0\u30a2\u30a6\u30c8"})]})]}),Object(o.jsx)(o.Fragment,{children:"\u8a2d\u5b9a\u304c\u7d42\u308f\u3063\u305f\u3089\u3001"}),Object(o.jsx)("a",{href:"/",children:"\u30db\u30fc\u30e0"}),Object(o.jsx)(o.Fragment,{children:"\u306b\u79fb\u52d5\u3057\u3066\u30eb\u30fc\u30e0\u306b\u53c2\u52a0\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01"}),Object(o.jsx)("br",{}),Object(o.jsx)("a",{id:"save-button",onClick:function(){if(document.getElementById("save-button").classList.contains("active")){var e=document.getElementById("displayName-input").value,t=document.getElementById("oneWord-input").value;p.collection("users").doc(i).update({displayName:e,oneWord:t}).then((function(e){var t=F;p.collection("users").doc(i).update({iconinfo:t}).then((function(){document.location.reload()})).catch((function(e){console.log(e)}))})).catch((function(e){r(),alert("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u7533\u3057\u8a33\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u3082\u3046\u4e00\u5ea6\u30ed\u30b0\u30a4\u30f3\u3092\u304a\u9858\u3044\u3057\u307e\u3059\u3002Error:"+e),console.log(e)}))}},children:"\u5909\u66f4\u3092\u4fdd\u5b58"})]})]})}),se=(n(90),function(){var e=Object(s.useContext)(de),t=e.isOnline;e.setIsOnline,e.userId,e.setUserId,e.userInfo,e.setUserInfo;return Object(o.jsxs)("div",{children:[null===t&&Object(o.jsx)("p",{children:"loading...."}),!0===t&&Object(o.jsxs)("div",{id:"settings",children:[Object(o.jsx)(te,{}),Object(o.jsx)(oe,{})]}),!1===t&&Object(o.jsx)(ne,{})]})}),ie=(n(91),function(){return Object(s.useEffect)((function(){var e=function(){for(var e=[],t=0;t<e.length;t++)clearInterval(e[t]);e=[];for(var n=document.getElementsByClassName("intro-iconparts"),o=0;o<n.length;o++)e.push(E(n[o],1e3));return e}();return function(){e.forEach((function(e){clearInterval(e)}))}})),Object(o.jsx)("div",{className:"bs-component",children:Object(o.jsxs)("div",{id:"intoro-box",children:[Object(o.jsx)(b,{iconInfo:U(),where:"intro",iconSize:"200"}),Object(o.jsxs)("div",{id:"intro-texts",children:[Object(o.jsx)("h2",{children:"\u300c\u30a8\u30e2\u3044\u30c1\u30e3\u30c3\u30c8\u3002\u300d\u3078\u3088\u3046\u3053\u305d\uff01"}),Object(o.jsx)("p",{id:"text",children:"\u30a8\u30e2\u3044\u30c1\u30e3\u30c3\u30c8\u3068\u306f\u30a8\u30e2\u30fc\u30c8\u3084\u3001\u30ea\u30a2\u30af\u30b7\u30e7\u30f3\u6a5f\u80fd\u3092\u642d\u8f09\u3057\u3001\u3088\u308a\u300c\u8a71\u3057\u3066\u308b\u611f\u300d\u3092\u5473\u308f\u3048\u308b\u3042\u308a\u305d\u3046\u3067\u306a\u304b\u3063\u305f\u30c1\u30e3\u30c3\u30c8\u3067\u3059\uff01"})]})]})})}),ce=(n(92),function(){var e=Object(s.useContext)(de),t=e.userId,n=e.userInfo;return Object(o.jsxs)("div",{id:"room-form",children:[Object(o.jsx)("label",{htmlFor:"name",children:"\u30eb\u30fc\u30e0\u306e\u540d\u524d"}),Object(o.jsx)("input",{id:"nameInput",type:"text",name:"name",maxLength:"15"}),Object(o.jsx)("br",{}),Object(o.jsx)("label",{id:"select-label",htmlFor:"stage",defaultValue:"0",children:"\u30b9\u30c6\u30fc\u30b8"}),Object(o.jsxs)("select",{id:"stage-select",name:"stage",className:"custom-select",children:[Object(o.jsx)("option",{value:"0",children:"Zero"}),Object(o.jsx)("option",{value:"1",children:"One"}),Object(o.jsx)("option",{value:"2",children:"Two"})]}),Object(o.jsx)("br",{}),Object(o.jsx)("button",{onClick:function(){var e=document.getElementById("nameInput").value;if(e.length>0&&e.length<=15){var o=document.getElementById("stage-select").value;p.collection("/rooms").add({roomName:e,stageId:o,madeUserId:t,madeUserName:n.displayName,timeStamp:j.firestore.FieldValue.serverTimestamp(),members:[]}).then((function(e){document.location.reload()})).catch((function(e){alert("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u7533\u3057\u8a33\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u3057\u3070\u3089\u304f\u5f85\u3063\u3066\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\nError:"+e)}))}else alert("\u30eb\u30fc\u30e0\u540d\u306f1\u6587\u5b57\u4ee5\u4e0a\u300115\u6587\u5b57\u4ee5\u4e0b\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002")},children:"\u6295\u7a3f"})]})}),re=(n(93),function(){var e=Object(s.useState)(null),t=Object(u.a)(e,2),n=t[0],i=t[1];return Object(s.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.collection("/rooms").orderBy("timeStamp","asc").get().then((function(e){var t=e.docs.map((function(e){return e.id})),n=[];e.forEach((function(e){n.push(e.data())}));for(var o=[],s=0;s<t.length;s++){var c=n[s].timeStamp.toDate();o.push({roomName:n[s].roomName,stageId:n[s].stageId,madeTime:c.getFullYear()+"/"+c.getMonth()+"1/"+c.getDate(),madeUserName:n[s].madeUserName,madeUserId:n[s].madeUserId,members:n[s].members,id:t[s]})}i(o)}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(o.jsxs)("div",{id:"rooms",className:"list-group",children:[null===n&&Object(o.jsx)("p",{children:"Loading rooms..."}),n&&n.map((function(e){return Object(o.jsxs)("li",{className:"roomsItem list-group-item d-flex",children:[Object(o.jsx)(r.b,{to:"/room/".concat(e.id),children:Object(o.jsx)("h4",{children:e.roomName})}),Object(o.jsxs)("h4",{children:["\u4f5c\u6210\u8005\uff1a",e.madeUserName]}),Object(o.jsxs)("h4",{children:["\u4f5c\u6210\u65e5\u6642\uff1a",e.madeTime]}),Object(o.jsxs)("h4",{children:["\u30e1\u30f3\u30d0\u30fc\uff1a",e.members.length,"\u4eba"]})]},e.id)})),n&&0===n.length&&Object(o.jsx)("li",{className:"roomsItem list-group-item d-flex",children:Object(o.jsx)("h4",{children:"\u307e\u3060\u30eb\u30fc\u30e0\u306f\u3042\u308a\u307e\u305b\u3093"})},"none room")]})}),ae=function(){return Object(o.jsxs)("div",{id:"roomsAndForm",children:[Object(o.jsx)(ie,{}),Object(o.jsx)(re,{}),Object(o.jsx)(ce,{})]})},le=function(){return Object(o.jsx)("div",{children:Object(o.jsx)("p",{children:"\u30da\u30fc\u30b8\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u524a\u9664\u30fb\u5909\u66f4\u3055\u308c\u305f\u304b\u3001URL\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002"})})},de=Object(s.createContext)(),ue=!1;var me=function(){var e=Object(s.useState)(null),t=Object(u.a)(e,2),n=t[0],i=t[1],c=Object(s.useState)(null),r=Object(u.a)(c,2),a=r[0],h=r[1],f=Object(s.useState)(null),b=Object(u.a)(f,2),O=b[0],g=b[1];return Object(s.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=5;break}return e.next=3,p.collection("users").doc(a).onSnapshot((function(e){p.collection("users").doc(a).collection("seclet").doc(a).get().then((function(t){var n=e.data(),o=t.data();g({userName:o.userName,email:o.email,displayName:n.displayName,oneWord:n.oneWord,iconinfo:n.iconinfo,rooms:n.rooms,room:n.room})}))}));case 3:return t=e.sent,e.abrupt("return",(function(){return t()}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[a]),Object(s.useEffect)((function(){j.auth().onAuthStateChanged(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,o=null,t&&(o=t.uid,n=!0),ue||(h(o),i(n));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}().bind(undefined))})),Object(o.jsx)("div",{children:Object(o.jsxs)(de.Provider,{value:{isOnline:n,setIsOnline:i,userId:a,setUserId:h,userInfo:O,setUserInfo:g},children:[Object(o.jsx)(x,{}),Object(o.jsxs)(m.Switch,{children:[Object(o.jsx)(m.Route,{exact:!0,path:"/login",component:ne}),!1===n&&Object(o.jsx)(m.Redirect,{to:"/login"}),!0===n&&Object(o.jsxs)(m.Switch,{children:[Object(o.jsx)(m.Route,{exact:!0,path:"/error",component:le}),Object(o.jsx)(m.Route,{exact:!0,path:"/",component:ae}),Object(o.jsx)(m.Route,{exact:!0,path:"/userSetting",component:se}),Object(o.jsx)(m.Route,{exact:!0,path:"/room/:id",component:L}),Object(o.jsx)(m.Redirect,{to:"/error"})]}),Object(o.jsx)(o.Fragment,{children:"loading..."})]})]})})};n(94);c.a.render(Object(o.jsx)(r.a,{children:Object(o.jsx)(me,{})}),document.getElementById("root"))}},[[95,1,2]]]);
//# sourceMappingURL=main.90474623.chunk.js.map