{"version":3,"sources":["Firebase/Firebase.js","miserarenaiyo.js","IconRender.js","NavBar/NavBar.js","Room/Stages/StageIcon/IconAccessory/ReActions.js","Room/Stages/StageIcon/IconAccessory/NewComment.js","Room/Stages/StageIcon/IconAccessory/ReActionButtons.js","Room/Stages/StageIcon/StageIcon.js","Room/Stages/Nomal/Nomal.js","Room/Stages/CommetForm/CommentForm.js","IconRandomMove.js","Room/Stages/Stage.js","CollectionDelete.js","Room/RoomHeader/RoomHeader.js","Room/Room.js","Room/Comments/Comments.js","UserSettings/UserInfo/MakeIcon/IconData.js","UserSettings/UserInfo/MakeIcon/PartsSelect/PartsSelect.js","UserSettings/UserInfo/MakeIcon/MakeIcon.js","UserSettings/NoLogin.js","App.js","UserSettings/UserInfo/LoggedIn.js","UserSettings/UserSettings.js","Main/Introduce/Introduce.js","Main/RoomForm/RoomForm.js","Main/Rooms/Rooms.js","Main/Main.js","Error/Error.js","index.js"],"names":["firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","analytics","db","firestore","emoteParts","Icon","props","Parts","parts","path","rot","info","emotion","indexOf","parseInt","className","where","src","style","height","iconSize","width","top","left","position","transform","Object","entries","iconInfo","map","NavBar","useContext","userContext","isOnline","userId","userInfo","useState","allrooms","setAllRooms","nowRoom","setNowRoom","useEffect","collection","doc","get","then","exists","id","data","update","room","length","FieldPath","documentId","roomInfos","existsRoom","empty","rooms","docs","forEach","push","catch","error","console","log","type","data-toggle","data-target","href","role","aria-expanded","value","ReActions","reActions","stageContext","members","roomContext","randomPos","max","Math","floor","random","renderId","element","substr","NewComment","newComment","ReActionButtons","reActionAPI","e","reAction","target","dataset","name","toUserId","user","add","from","to","timeStamp","FieldValue","serverTimestamp","setTimeout","delete","onClick","data-name","data-user","StageIcon","emotions","renderInfo","Nomal","keys","m","index","Form","setEmotions","commentAPI","content","document","getElementById","roomId","userName","set","body","addEventListener","event","key","ctrlKey","emoteAPI","emote","kind","data-kind","maxLength","getRandomInt","randomMoveTimer","object","time","setInterval","topmax","leftmax","originalSizeRot","window","getComputedStyle","getPropertyValue","split","slice","randomMove","createContext","Stage","icons","splitSize","setNewComment","setActions","a","now","Date","before5min_unix","getTime","onSnapshot","emoteIds","emotes","i","emoteUnsubscribe","before6sec_unix","newCommentIds","newCommentUnsubscribe","before5sec_unix","reActionIds","reActionDatas","emotionData","newCommentData","reActionData","moveTimer","timers","clearInterval","iconparts","getElementsByClassName","IconMove","timer","Provider","defaultSize","innerHeight","stageRadius","CommentForm","deleteRoomSubCollection","subCollection","deleteDocs","batchIndex","operationCounter","batchArray","batch","ref","commit","RoomHeader","madeUserName","madeTime","madeUserId","confirm","r","Room","setRoom","isRoom","setIsRoom","comments","setComments","setSplitSize","setMembers","location","pathname","arrayUnion","d","toDate","roomData","roomName","stageId","getFullYear","getMonth","getDate","roomUnsubscribe","orderBy","commentIds","commentsUnsubscribe","memberIds","infos","memberId","displayName","oneWord","memberUnsubscribe","commentsData","membersData","minSize","maxSize","Comments","scrollIntoView","comment","toString","defaultIcons","posX","posY","sizeX","sizeY","GetIconRandom","partsData","Kinds","displayKind","imgsInfo","GetImgsInfoEach","partsName","eachPram","partsSizeMaxMin","min","GetSizeMax","GetSizeMin","partsSizeNow","SetSizeXYNow","partsRotMaxMin","GetRotMax","GetRotMin","partsRotNow","SetRotNow","PartsSelect","makeIconContext","setNowKind","nowName","nowKind","activeElement","classList","contains","remove","imgPath","MakeIcon","setNowName","nowSize","setNowSize","nowRot","setNowRot","values","partInfo","img","createElement","attach","facekind","sizeTimer","sizex","sizey","x","y","appendChild","SetImgsInfoAll","rotTimer","inputRotSet","nextRot","input","inputRot","maxRot","minRot","inputSizeSet","nextSize","inputSize","onMouseMove","mouseX","clientX","mouseY","clientY","onMouseLeave","display","onMouseEnter","clientRect","getBoundingClientRect","px","pageXOffset","py","pageYOffset","zIndex","cursor","pointerEvents","onInput","clearTimeout","defaultValue","GetRotNow","NoLogin","setUserId","setIsOnline","setUserName","logoutFromGoogle","auth","signOut","isFirst","setPersistence","Auth","Persistence","LOCAL","provider","GoogleAuthProvider","signInWithPopup","result","uid","iconinfo","email","alert","bind","this","Loggedin","reload","onChange","newDisplayName","newOneWordName","UserSettings","setUserInfo","Introduce","RoomForm","htmlFor","StageId","Rooms","setRooms","col","roomids","postCol","roomsData","Main","Error","App","seclet","secletdata","userInfoUnsubscribe","getUserInfo","onAuthStateChanged","exact","component","ReactDOM","render"],"mappings":"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","file":"static/js/main.a49c4ed6.chunk.js","sourcesContent":["import firebase from 'firebase';\nimport { firebaseConfig } from '../miserarenaiyo';\nfirebase.initializeApp(firebaseConfig);\nfirebase.analytics();\nexport default firebase;\nexport const db = firebase.firestore();","const googleauthConfig ={\n  apiKey   : 'dXGX0dsR2bTIVrRCPpAlBIu2',\n  clientId :'349007819425-dtm4orbqjr4ms1jp4rcothk9udk1nsoj.apps.googleusercontent.com'\n}\nconst firebaseConfig = {\n  apiKey            : \"AIzaSyBKyumc6NOpVRBhKbXxz06lN0HP5xztT8Y\",\n  authDomain        : \"emoichat-300700.firebaseapp.com\",\n  projectId         : \"emoichat-300700\",\n  storageBucket     : \"emoichat-300700.appspot.com\",\n  messagingSenderId : \"349007819425\",\n  appId             : \"1:349007819425:web:3b35c57290d3aac32d36e0\",\n  measurementId     : \"G-8HGXFZXEQT\"\n};\nexport {googleauthConfig,firebaseConfig}; ","import React, { Component, createContext,useContext,useState } from 'react';\n\n// 感情の変化させるパーツの配列。\nconst emoteParts={\n  'happy':[\n    'leftEye','rightEye','mouth'\n  ],\n  'angry':[\n    'leftEye','rightEye','mouth'\n  ],\n  'naki':[\n    'leftEye','rightEye','mouth'\n  ],\n  'yurei':[\n    'leftEye','rightEye','mouth'\n  ],\n  'thinking':[\n    'leftEye','rightEye','mouth'\n  ],\n  'henoheno':[\n    'leftEye','rightEye','mouth','nose','face'\n  ]\n}\n\n// propsはiconInfoとiconSize、emotion、where。\nconst Icon=(props)=>{\n  const Parts=(parts)=>{\n    const info=parts.info;\n    // 感情がある場合にはその感情のパス、ない場合は保存されてるパスを渡す。\n    let path;\n    //rotは、感情がある場合0で渡す\n    let rot;\n    if(props.emotion!=='null'&&props.emotion&&emoteParts[props.emotion].indexOf(info[0])!==-1){\n      path=\"../images/icon/\"+props.emotion+\"_\"+info[0]+\".png\";\n      rot=0;\n    }else{\n      path=\"../images/icon/\"+info[1][\"kind\"]+\"_\"+info[0]+\".png\";\n      rot=parseInt(info[1][\"rot\"]);\n    }\n    return(\n      <img key={info[0]} className={props.where+\"-iconparts \"+info[0]} src={path} style={{\n        height  : (info[1][\"sizeY\"] / 300) * props.iconSize + \"px\" ,\n        width   : (info[1][\"sizeX\"] / 300) * props.iconSize + \"px\" ,\n        top     : (info[1][\"posY\"]  / 300) * props.iconSize + \"px\" ,\n        left    : (info[1][\"posX\"]  / 300) * props.iconSize + \"px\" ,\n        position :\"absolute\" , \n        transform:\"rotate(\"+rot+\"deg)\",\n      }} />\n    )\n  }\n  return (\n    <div className={props.where+\"-icon\"} style={{position:\"relative\", height:props.iconSize+\"px\", width:props.iconSize+\"px\"}}>\n      {Object.entries(props.iconInfo).map(info => (\n        <Parts key={info[0]} info={info}></Parts>\n      ))}  \n    </div>\n  );\n}\n\nexport default Icon;\n","import React,{ useContext,useEffect,useState } from 'react';\nimport {Link} from 'react-router-dom';\nimport { userContext } from '../App';\nimport firebase, {db} from '../Firebase/Firebase'\nimport Icon from '../IconRender';\nimport './navbar.css'\n\nfunction NavBar() {\n  const {isOnline,userId,userInfo} = useContext(userContext);\n  const [allrooms,setAllRooms] =useState(null);\n  const [nowRoom,setNowRoom] =useState(null);\n  \n  useEffect(()=>{\n    \n    if(userInfo){\n      // 一番最後に入ったルームのルーム名取得。\n      if(userInfo['room']){\n        db.collection('rooms').doc(userInfo['room']).get().then((doc)=>{\n          if(doc.exists){\n            setNowRoom([doc.id,doc.data()['roomName']]);\n          }else{\n            // そのルームが存在しないならnullに。削除されたとき対策\n            db.collection('users').doc(userId).update({\n              room : null\n            })\n          }\n        })\n      }\n      // 入室しているルームを取得\n      if(userInfo['rooms'].length!==0){\n        db.collection('rooms').where(firebase.firestore.FieldPath.documentId(),'in',userInfo['rooms']).get().then((doc)=>{\n        let roomInfos={};\n        let existsRoom=[];\n        if(!doc.empty){\n          // ルームの名前配列の作成と同時に、存在するルームid配列を作成\n          doc.docs.forEach((room)=>{\n            if(room.exists){\n              roomInfos[room.id]=room.data()['roomName'];\n              existsRoom.push(room.id);\n            }\n          });\n          setAllRooms(roomInfos);\n\n          // 存在するルームが、今設定されているルーム数より少なければ、今設定されているルームを上書き。削除された時対策\n          if(existsRoom.length!==userInfo['rooms'].length){\n            db.collection('users').doc(userId).update({\n              rooms:existsRoom\n            })\n          }\n        }else{\n          setAllRooms(false);\n          db.collection('users').doc(userId).update({\n            rooms:[]\n          })\n        }\n      }).catch((error)=>{\n        console.log('Error:'+error)\n      })\n    }else{\n      setAllRooms(false);\n    }\n  }\n  },[userInfo]);\n  return (\n    <nav className=\"navbar navbar-default\" style={{'margin':'0px'}}>\n      <div className=\"container-fluid\">\n\t\t\t\t<div className=\"navbar-header\">\n\t\t\t\t\t<button type=\"button\" className=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#bs-example-navbar-collapse-1\">\n\t\t\t\t\t\t<span className=\"sr-only\">Toggle navigation</span>\n\t\t\t\t\t\t<span className=\"icon-bar\"></span>\n\t\t\t\t\t\t<span className=\"icon-bar\"></span>\n\t\t\t\t\t\t<span className=\"icon-bar\"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<a className=\"navbar-brand\" href=\"/\">エモいチャット。</a>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"collapse navbar-collapse\" id=\"bs-example-navbar-collapse-1\">\n\t\t\t\t\t<ul className=\"nav navbar-nav\">\n            \n            <li className=\"\"><a href=\"/\">ホーム<span className=\"sr-only\">(current)</span></a></li>\n\n            {nowRoom!==null&&\n              <li className=\"\"><a href={\"/room/\"+nowRoom[0]}>{nowRoom[1]}<span className=\"sr-only\">(current)</span></a></li>\n            }\n            <li className=\"dropdown\">\n              <a className=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\">ルームs <span className=\"caret\"></span></a>\n              <ul className=\"dropdown-menu\" role=\"menu\">\n                  {allrooms===false &&\n                    <li><p>no rooms</p></li>\n                  }\n                  {isOnline===false &&\n                    <li><p>not loggedIn</p></li>\n                  }\n                  {allrooms!==null && allrooms!==false &&\n                    Object.entries(allrooms).map((value)=>(\n                     <li key={value[0]}><a href={\"/room/\"+value[0]}>{value[1]}</a></li>\n                    ))\n                  }\n\t\t\t\t\t\t  \t</ul>\n\t\t\t\t\t\t  </li>\n          </ul>\n\t\t\t\t\t{/*検索機能はいったんコメントアウト\n          <form className=\"navbar-form navbar-left\" role=\"search\">\n\t\t\t\t\t\t<div className=\"form-group\">\n\t\t\t\t\t\t\t<input type=\"text\" className=\"form-control\" placeholder=\"Search\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button type=\"submit\" className=\"btn btn-default\">Submit</button>\n          </form>\n          */}\n          {isOnline===true &&\n\t\t\t\t\t  <ul className=\"nav navbar-nav navbar-right\">\n\t\t\t\t\t  \t<li id=\"userInfo-li\"  href=\"/userSetting\">\n                <a id='infoLink-icon' href=\"/userSetting\"></a>\n                <div href=\"/userSetting\"  className='iconMask barMask'>\n                  {userInfo !== null&&\n                    <Icon iconInfo={userInfo['iconinfo']} where=\"header\" iconSize=\"50\" />\n                  }\n                  <h6 id=\"icon-loading-text\">loading icon...</h6>\n                </div>\n              </li>\n\t\t\t\t\t  </ul>\n          }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</nav>\n  );\n}\n//<Icon iconInfo={}></Icon>\n            \nexport default NavBar;\n","import React,{useContext} from 'react';\nimport { roomContext } from '../../../Room';\nimport {stageContext} from '../../Stage';\nimport './iconacce.css'\n\nconst ReActions = (props) =>{\n  const {reActions}=useContext(stageContext);\n  const {members}=useContext(roomContext);\n\n  function randomPos(max){\n    return  Math.floor(Math.random() * Math.floor( max ) ) - ( max / 2 );\n  }\n\n  return(\n    <div id=\"\" className=\"reActions icon-acce\">\n      {console.log(props.renderId,reActions)}\n      {reActions[props.renderId].map(element => (\n        <div key={element['id']} className=\"reaction\" style={{\"top\":-150+randomPos(100),\"left\":randomPos(100)}}>\n          <img src={\"../../../../../images/reactions/\"+element['name']+\".png\"} className=\"reactionImg\"></img>\n          {members[element['from']]['displayName'].length > 9 &&\n            <h4 className=\"reaction-from\">{members[element['from']]['displayName'].substr( 0, 9 )+\"...\"}</h4>\n          }\n          {members[element['from']]['displayName'].length <= 9 &&\n            <h4 className=\"reaction-from\">{members[element['from']]['displayName']}</h4>\n          }\n        </div>\n      ))}\n    </div>\n  )\n}\n\nexport default ReActions;","import React,{useContext} from 'react';\nimport {stageContext} from '../../Stage';\nimport './iconacce.css'\n\nconst NewComment = (props) =>{\n  const {newComment}=useContext(stageContext);\n\n  return(\n    <div className=\"balloon1 icon-acce top\"  key={props.renderId}>\n      <div className=\"balloon1-text\">\n        <p>{newComment[props.renderId]}</p>\n      </div>\n    </div>\n  )\n}\n\nexport default NewComment;","import React, { useContext } from 'react';\nimport firebase,{db} from '../../../../Firebase/Firebase';\nimport {roomContext} from '../../../Room';\nimport {userContext} from '../../../../App';\nimport './iconacce.css'\n\nconst ReActionButtons = (props) =>{\n  const {room} = useContext(roomContext)\n  const {userId} = useContext(userContext)\n\n  const reActionAPI= (e)=>{\n    const reAction=e.target.dataset.name;\n    const toUserId=e.target.dataset.user;\n    console.log(reAction,toUserId);\n      db.collection('rooms').doc(room['id']).collection('reActions').add({\n      name      : reAction,\n      from      : userId,\n      to        : toUserId,\n      timeStamp : firebase.firestore.FieldValue.serverTimestamp()\n    }).then((doc)=>{\n      setTimeout(function(){\n        db.collection('rooms').doc(room['id']).collection('reActions').doc(doc.id).delete();\n      }, 3000);\n    }).catch((error)=>{\n      console.log(error);\n    })\n  }\n  return(\n    <div className=\"icon-acce reActionbuttons\">\n      <button className=\"reActionButton\" onClick={reActionAPI} data-name=\"good\" data-user={props.renderId}>good</button>  \n      <button className=\"reActionButton\" onClick={reActionAPI} data-name=\"kusa\" data-user={props.renderId}>草</button>  \n      <button className=\"reActionButton\" onClick={reActionAPI} data-name=\"question\" data-user={props.renderId}>？</button>  \n    </div>\n  )\n}\n\nexport default ReActionButtons;","import React,{useContext} from 'react';\nimport {userContext} from '../../../App';\nimport {stageContext} from '../Stage';\nimport Icon from '../../../IconRender'\nimport ReActions from './IconAccessory/ReActions'\nimport NewComment from './IconAccessory/NewComment';\nimport ReActionButtons from './IconAccessory/ReActionButtons';\nimport firebase, {db} from '../../../Firebase/Firebase'\nimport './IconAccessory/iconacce.css';\n\nconst StageIcon = (props) => {\n  const {userId} = useContext(userContext);\n  const {emotions,reActions,newComment}=useContext(stageContext);\n\n  return(\n    <div className=\"stageIcon\">\n      {console.log(props.renderInfo)}\n      {props.renderInfo[0] !== userId && // ディスプレイネームを表示\n        <h3 className=\"stageIcon-displayName icon-acce\">{props.renderInfo[1]['displayName']}</h3>\n      }\n      {props.renderInfo[0] === userId && // 自分ならselfMaskクラスを追加したやつを描画\n        <h3 className=\"self-mark stageIcon-displayName icon-acce\">{props.renderInfo[1]['displayName']}</h3>\n      }\n      {newComment===null&&\n        <p className=\"icon-acce\">Loading NewComment...</p>\n      }\n      {newComment!==null&&\n        newComment[props.renderInfo[0]]&& // 新しいコメントがあるなら、新しいコメントを描画\n          <NewComment renderId={props.renderInfo[0]}/>\n      }\n      <Icon iconInfo={props.renderInfo[1]['iconInfo']} iconSize={200} emotion={emotions[props.renderInfo[0]]} where=\"stage\"/> \n      {props.renderInfo[0] !==userId && // 自分でないならアクションのボタンを描画\n        <ReActionButtons renderId={props.renderInfo[0]}/>\n      }\n      {reActions===null&&\n        <p className=\"icon-acce\">Loading Actions...</p>\n      }\n      {reActions!==null&&\n        reActions[props.renderInfo[0]]&&\n          <ReActions renderId={props.renderInfo[0]}/>\n      }\n    </div>\n  );\n}\n\nexport default StageIcon;","\nimport React, {Timestamp,useEffect, useContext} from 'react';\n\nimport './nomal.css';\nimport StageIcon from '../StageIcon/StageIcon'\nimport { roomContext } from '../../Room';\n\nfunction Nomal(props){\n  const {members,room} = useContext(roomContext);\n\n  return (\n    <div id=\"nomal\">\n      {console.log(Object.keys(members),room,members,room['members'],room['members'],room['members'][0],members[room['members'][0]])}\n      {Object.keys(members).map((m,index)=>(\n        <div key={'icondiv'+index} className='icondiv'>\n          <StageIcon renderInfo={[room['members'][index],members[room['members'][index]]]}/>\n        </div>\n      ))\n      }\n    </div>\n  );\n}\n\n\nexport default Nomal;\n\n","import React, { Component, createContext,useContext,useState,useEffect } from 'react';\nimport {roomContext} from '../../Room';\nimport { stageContext } from '../Stage';\nimport {userContext} from '../../../App';\nimport firebase, {db} from '../../../Firebase/Firebase'\n\n\n\nconst Form=()=>{\n  const {room}=useContext(roomContext);\n  const {emotions,setEmotions}=useContext(stageContext);\n  const {userId,userInfo}=useContext(userContext);\n  useEffect(()=>{\n    // スペースキーが押されたら投稿\n    document.body.addEventListener('keydown',\n    event => {\n      if (event.key === 'Enter' && event.ctrlKey) {\n        commentAPI();\n      }\n    });  \n  },[]);\n\n  // コメント投稿のAPI\n  function commentAPI (){  \n    let content=document.getElementById('inputComment').value;\n    // 0文字より多く、300文字より少なく入力されているなら\n    if(content.length>0&&content.length<=300){\n      let roomId=room['id'];\n      let emotion;\n      if(emotions[userId]){\n        emotion=emotions[userId];  \n      }else{\n        emotion=null;\n      }\n      db.collection('rooms').doc(roomId).collection('comments').add({\n        content   : content,\n        userId    : userId,\n        userName  : userInfo['displayName'],\n        emotion   : emotion,\n        timeStamp : firebase.firestore.FieldValue.serverTimestamp()\n      })\n      db.collection('rooms').doc(room['id']).collection('newComment').doc(userId).set({\n        content   : content,\n        timeStamp : firebase.firestore.FieldValue.serverTimestamp()\n      }).then(()=>{\n        // フォームの中身をなくす\n        document.getElementById('inputComment').value='';\n        // 6秒後にステージ用のコメントを消す。\n        setTimeout(function(){\n          db.collection('rooms').doc(room['id']).collection('newComment').doc(userId).delete();\n        }, 6000)}\n      )\n    }\n  }\n  // エモートのAPI\n  const emoteAPI= (e)=>{\n    const emote=e.target.dataset.kind;\n    console.log(emote);\n    if(emote===null){\n      db.collection.doc(room['id']).collection('emotions').doc(userId).delete();\n    }else{\n      db.collection('rooms').doc(room['id']).collection('emotions').doc(userId).set({\n        kind      : emote,\n        timeStamp : firebase.firestore.FieldValue.serverTimestamp()\n      })\n    }\n  }\n\n  return(\n    <div id=\"commentForm\">\n      <div id=\"emotions\">\n        <button className=\"emotoButton\" onClick={emoteAPI} data-kind=\"henoheno\">へのへの</button>\n        <button className=\"emotoButton\" onClick={emoteAPI} data-kind=\"null\">なし</button>  \n        <button className=\"emotoButton\" onClick={emoteAPI} data-kind=\"yurei\">ユーレイ</button>\n        <button className=\"emotoButton\" onClick={emoteAPI} data-kind=\"happy\">ニコニコ</button>  \n        <button className=\"emotoButton\" onClick={emoteAPI} data-kind=\"angry\">怒り</button>  \n        <button className=\"emotoButton\" onClick={emoteAPI} data-kind=\"naki\">泣き</button>  \n      </div>\n      <div className=\"form\">\n        <input id=\"inputComment\" />\n        <button type=\"submit\" maxLength=\"300\" onClick={commentAPI}>投稿</button>\n      </div>\n    </div>\n    )\n}\nexport default Form;","//アイコンをランダムに動かす処理\n\nfunction randomMoveTimer(object , time){\n  let moveMax=5;\n  return setInterval(()=>{\n    randomMove(object , moveMax , moveMax);\n  },time);\n};\n\nfunction randomMove(object , topmax , leftmax){\n  let originalValue = window.getComputedStyle(object, null).getPropertyValue('transform');// transformの中身を取得。例えばこんな感じmatrix(1, 0, 0, 1, -1.5, 0.5) what!!!\n  let originalSizeRot=originalValue.substr(7).split(',').slice(0, 4);//matrixのサイズと回転だけを取得\n  object.style.transform ='matrix('+originalSizeRot[0]+','+originalSizeRot[1]+','+originalSizeRot[2]+','+originalSizeRot[3]+',' + getRandomInt( topmax ) + ','+ getRandomInt( leftmax ) +')';\n}\nfunction getRandomInt(max) {\n  return Math.floor(Math.random() * Math.floor( max ) ) - ( max / 2 );\n}\n\nexport default randomMoveTimer;\n","\nimport React, {Timestamp,useEffect,useContext,createContext,useState} from 'react';\nimport './stage.css';\nimport Nomal from './Nomal/Nomal';\nimport {roomContext} from '../Room';\nimport {userContext} from '../../App';\nimport firebase , {db} from '../../Firebase/Firebase'\nimport CommentForm from './CommetForm/CommentForm'\nimport SplitPane from 'react-split-pane';\nimport randomMoveTimer from '../../IconRandomMove';\n\n\nconst IconMove=()=>{\n  let timers=[];\n  for(let i=0;i<timers.length;i++){\n    clearInterval(timers[i]);\n  }\n  timers=[];\n  const iconparts=  document.getElementsByClassName('stage-iconparts');\n  for(let i=0;i<iconparts.length;i++){\n    timers.push(randomMoveTimer(iconparts[i],1000));\n  }\n  return timers;\n}\n\nconst stageRadius=600;\nfunction Stage(props){\n  const {userId} = useContext(userContext);\n  const {icons,splitSize,room} = useContext(roomContext);\n  const [newComment,setNewComment] = useState(null);\n  const [emotions,setEmotions] = useState({});\n  const [reActions,setActions] = useState({});\n  const roomId=room['id'];\n\n  useEffect(()=>{\n    async function emotionData(){\n      var now = new Date();\n      var before5min_unix = new Date(now.getTime() - 5000);\n      console.log(before5min_unix,now);\n      //var before5min = Timestamp(before5min_unix);\n      const emoteUnsubscribe = await db.collection('/rooms').doc(roomId).collection('emotions').where('timeStamp','>',before5min_unix).onSnapshot(data=> {\n        console.log(data);\n        let value=[];\n        let emoteIds=data.docs.map(doc => \n          doc.id\n        );\n        data.forEach((doc) => {\n          value.push(\n            doc.data()\n          );\n        });\n        let emotes={};\n        for(let i = 0; i < emoteIds.length; i++){\n          emotes[emoteIds[i]]=value[i]['kind'];\n        }\n        console.log(data,value,emotes,\"ん\");\n        setEmotions(emotes);\n      });\n      return () => emoteUnsubscribe();\n    }\n    async function newCommentData(){\n      var now = new Date();\n      // 6秒以内のnewCommentを取得\n      // 本来は、コメントが増えたタイミングでバックエンドからイベントを起こすようにした方がいいのだろうが、firebaseでは有料だったのでこのように実装\n      var before6sec_unix = new Date(now.getTime() - 6000);\n      const newCommentUnsubscribe = await db.collection('/rooms').doc(roomId).collection('newComment').where('timeStamp','>',before6sec_unix).onSnapshot(data=> {\n        let value=[];\n        let newCommentIds=data.docs.map(doc => \n          doc.id\n        );\n        data.forEach((doc) => {\n          value.push(\n            doc.data()\n          );\n        });\n        let newComment={};\n        for(let i = 0; i < newCommentIds.length; i++){\n          newComment[newCommentIds[i]]=value[i]['content'];\n        }\n        console.log(data,value,newComment,\"ん\");\n        setNewComment(newComment);\n      });\n      return () => newCommentUnsubscribe();\n    }\n    async function reActionData(){\n      var now = new Date();\n      var before5sec_unix = new Date(now.getTime() - 5000);\n      console.log(before5sec_unix,now);\n      //var before5min = Timestamp(before5min_unix);\n      const emoteUnsubscribe = await db.collection('/rooms').doc(roomId).collection('reActions').where('timeStamp','>',before5sec_unix).onSnapshot(data=> {\n        let value=[];\n        let reActionIds=data.docs.map(doc => \n          doc.id\n        );\n        data.forEach((doc) => {\n          value.push(\n            doc.data()\n          );\n        });\n        let reActionDatas={};\n        for(let i = 0; i < reActionIds.length; i++){\n          if(!reActionDatas[value[i]['to']]){\n            reActionDatas[value[i]['to']]=[];\n          }\n          reActionDatas[value[i]['to']].push({\n            id   : reActionIds[i],\n            name : value[i]['name'],\n            from : value[i]['from'],\n            to   : value[i]['to'],\n          });\n        }\n        console.log(data,value,reActionDatas,\"ん\");\n        setActions(reActionDatas);\n      });\n      return () => emoteUnsubscribe();\n    }\n    emotionData();\n    newCommentData();\n    reActionData();\n  },[])\n  useEffect(()=>{\n    let moveTimer=IconMove();\n    return ()=>{\n      moveTimer.forEach(timer => {\n        clearInterval(timer);\n      });\n    }\n  })\n\n\n  return (\n    <stageContext.Provider value={{newComment,setNewComment,emotions,setEmotions,reActions,setActions}}>\n      <SplitPane split=\"horizontal\" defaultSize={window.innerHeight-171}>\n        <div id=\"stage\" >\n          <Nomal stageRadius={stageRadius}/>\n        </div>\n        <CommentForm />\n      </SplitPane>\n    </stageContext.Provider>\n  );\n}\nconst stageContext=createContext([]);\nexport {stageContext};\nexport default Stage;","import { db } from \"./Firebase/Firebase\";\n\nasync function deleteRoomSubCollection(roomId,subCollection) {\n  const deleteDocs = await db.collection('rooms').doc(roomId).collection(subCollection).get();\n  if(!deleteDocs.empty){\n    let batchIndex=0;\n    let operationCounter=0;\n    let batchArray=[];\n\n    batchArray.push(db.batch());\n    deleteDocs.docs.forEach((doc) => {\n      batchArray[batchIndex].delete(doc.ref);\n      operationCounter++;\n\n      if (operationCounter === 499) {\n        batchArray.push(db.batch());\n        batchIndex++;\n        operationCounter = 0;\n      }\n    });\n    batchArray.forEach(async (batch) => {await batch.commit()});\n  }\n  return true;\n}\n\nexport {deleteRoomSubCollection};\n","import React,{ useContext } from 'react';\nimport {Link} from 'react-router-dom';\nimport { userContext } from '../../App';\nimport { roomContext } from '../Room';\nimport './roomheader.css'\nimport firebase,{db} from '../../Firebase/Firebase';\nimport { deleteRoomSubCollection } from '../../CollectionDelete';\n\nconst RoomHeader=()=> {\n  const {room}=useContext(roomContext);\n  const {userId} =useContext(userContext);\n\n\n  // 削除用のAPIだがしかしサブコレクションの削除ができないとかなんとかで時間的に諦め\n  const deleteRoomAPI=()=>{\n    var result = window.confirm('この操作は取り消せません、よろしいですか？');\n    if(result){\n      const r=db.collection('/rooms').doc(room['id']);\n      const roomId=room['id']\n      if(r){\n        deleteRoomSubCollection(roomId,'newComment').then(()=>{\n          deleteRoomSubCollection(roomId,'emotions').then(()=>{\n            deleteRoomSubCollection(roomId,'reActions').then(()=>{\n              deleteRoomSubCollection(roomId,'comments').then(()=>{\n                r.delete().then(()=>{})\n              })\n            })\n          })\n        }).catch((error)=>{\n          console.log('Error:'+error)\n        });\n      }\n    }\n  }\n  \n  return (\n    <header id=\"room-header\">\n      <div id=\"room-name\">\n        <strong>{room[\"roomName\"]}</strong>\n\t\t\t</div>\n      <ul id=\"room-info\">\n        <li>参加者：{room[\"members\"].length}</li>\n\t\t\t\t<li> 作成者：{room.madeUserName}</li>\n        <li> 作成日時：{room.madeTime}</li>\n        <li> メンバー：{room.members.length}人</li>\n\t\t\t</ul>\n      {console.log(room,room.madeUserId,userId)}\n      {room.madeUserId === userId &&\n        <button id=\"room-delete\" onClick={deleteRoomAPI}>ルームを削除</button>\n      }\n    </header>\n    );\n}\n\nexport default RoomHeader;\n/*\n \n\n\n    \n*/","import React, { Component, createContext,useContext,useState,useEffect } from 'react';\nimport axios from 'axios';\nimport Icon from '../IconRender'\nimport Stage from './Stages/Stage';\nimport SplitPane from 'react-split-pane';\nimport { Splitpanes, Pane } from 'splitpanes'\nimport 'splitpanes/dist/splitpanes.css'\nimport Comments from './Comments/Comments';\nimport firebase, { db } from '../Firebase/Firebase'; \nimport {userContext} from '../App'\nimport RoomHeader from './RoomHeader/RoomHeader';\nimport './room.css';\nimport { Redirect } from 'react-router-dom/cjs/react-router-dom.min';\nimport StageIcon from './Stages/StageIcon/StageIcon';\n\nconst defaultSplitSize=800;\n\nconst Room = () => {\n  const [room,setRoom] = useState(null);\n  const [isRoom,setIsRoom] = useState(null);\n  const [comments,setComments] = useState(null);\n  const [splitSize,setSplitSize] = useState(defaultSplitSize);\n  const [members,setMembers] = useState(null);\n  const {isOnline,userId,userInfo} = useContext(userContext);\n  // URLのパラメータを取得\n  var Path = window.location.pathname;\n  var roomId = Path.split('/')[2];\n  \n  useEffect(()=>{\n    async function roomData() {\n      const roomUnsubscribe = await db.collection('/rooms').doc(roomId).onSnapshot(doc=> {\n        if(doc.exists){\n          let value=doc.data();\n          if(value['members'].indexOf(userId)===-1){\n            console.log('入室しました');\n            db.collection('rooms').doc(roomId).update({\n              members: firebase.firestore.FieldValue.arrayUnion(userId)\n            }).then(()=>{\n              db.collection('users').doc(userId).update({\n                rooms: firebase.firestore.FieldValue.arrayUnion(roomId)\n              }).catch((error)=>{\n                console.log('Error:'+error)\n              }).then(()=>{\n                setIsRoom(true);\n              })\n              db.collection('users').doc(userId).update({\n                room: roomId\n              }).catch((error)=>{\n                console.log('Error:'+error)\n              })\n            }).catch((error)=>{\n              console.log('Error:'+error)\n            })\n          }else{\n            setIsRoom(true);\n          }\n          let d = value['timeStamp'].toDate();\n          let roomData={\n            id           : doc.id,\n            roomName     : value['roomName'],\n            stageId      : value['stageId'],\n            madeTime     : d.getFullYear()+'/'+d.getMonth() + 1+'/'+d.getDate(),\n            madeUserId   : value['madeUserId'],\n            madeUserName : value['madeUserName'],\n            members      : value['members'],\n\n          }\n          setRoom(roomData);\n        }else{\n          setIsRoom(false);\n        }\n      });\n      return () => roomUnsubscribe();\n    };\n    roomData();\n  },[])\n\n  useEffect(() => {\n    async function commentsData(){\n      if(isRoom) {\n        console.log(room)\n        const commentsUnsubscribe = await db.collection('/rooms').doc(roomId).collection('comments').orderBy('timeStamp', 'asc').onSnapshot(data=> {\n          let commentIds=data.docs.map(doc => \n            doc.id\n          );\n          let value=[];\n          data.forEach((doc) => {\n            value.push(\n              doc.data()\n            );\n          });\n          let comments=[];\n           for(let i = 0; i < commentIds.length; i++){\n            comments.push(\n              {\n                id       : commentIds[i],\n                content  : value[i]['content'],\n                emotion  : value[i]['emotion'], \n                userId   : value[i]['userId'],\n              }\n            )\n          }\n          console.log(commentIds,comments,data);\n          setComments(comments);\n        });\n        return () => commentsUnsubscribe();\n      }\n    }\n    \n    async function membersData(){\n      if(isRoom){\n        const memberUnsubscribe= await db.collection('rooms').doc(roomId).onSnapshot(async doc=>{\n          if(doc.exists){\n            const memberIds=doc.data()['members'];\n            console.log(memberIds);\n            if(memberIds&&memberIds.length!==0){\n              await db.collection('users').where('userId','in',memberIds).get().then(infos=>{\n                if(!infos.empty){\n                  console.log(infos);\n                  let value={};\n                  infos.docs.forEach(info=>{\n                    let data=info.data();\n                    let memberId=info.data()['userId'];\n                    value[memberId]={\n                      displayName : data['displayName'],\n                      oneWord     : data['oneWord'],\n                      iconInfo    : data['iconinfo']\n                    }\n                  })\n                  console.log(value,infos,infos.docs);\n                  setMembers(value);\n                }\n                //infos.push(info.data()['iconinfo']);\n              });\n            }\n          }\n        });\n        return () => memberUnsubscribe();\n      }\n    }\n    \n    commentsData();\n    membersData();\n  \n    //unsubscribe();\n    \n  }, [isRoom]);\n  \n  \n//  <Icon iconInfo={this.state.room.iconInfo.filter(i => (i.id === parseInt(comment.userId)))[0].value}/>\n\n  \n  //if (this.state.room === null) return <p>Loading ...</p>;\n  return (\n    //<Nomal />\n        //<Icon iconInfo={room.iconInfo[0].value}/>\n    <div className=\"container\">\n      {isRoom===null && <p>Loading Room...</p>}\n      {isRoom===true&&\n        <roomContext.Provider value={{members,setMembers,room,setRoom,comments,setComments,splitSize,setSplitSize}}>\n          {room===null && <p>Loading Room...</p>}\n          {room &&\n            <div className=\"row\">\n              <RoomHeader />\n              <SplitPane split=\"vertical\" minSize={300} defaultSize={defaultSplitSize} maxSize={1000} style={{\"height\":window.innerHeight-101}}>\n                <div id='left' style={{'display':'flex'}}>\n                  {members === null && <p>Loading Stage...</p>}\n                  {members !== null&&<Stage/>}\n                </div>\n                <div id=\"right\" >\n                  {comments === null && <p>Loading Ccomments...</p>}\n                  {comments !==null && <Comments />}\n                </div>\n              </SplitPane>\n            </div>\n          }\n        </roomContext.Provider>\n      }\n      {isRoom==false &&\n        <Redirect to = {'/error'} />\n      }\n    </div>\n  )\n}\nconst roomContext=createContext([]);\nexport {roomContext};\nexport default Room;","import React, {Component,useContext, useEffect} from 'react';\n//import {Link} from 'react-router-dom';\nimport axios from 'axios';\nimport {roomContext} from '../Room';\nimport Icon from '../../IconRender';\nimport {db} from '../../Firebase/Firebase'\nimport './comments.css'\nimport randomMoveTimer from '../../IconRandomMove';\n\nconst iconSize=50;\n\nconst IconMove=()=>{\n  let timers=[];\n  for(let i=0;i<timers.length;i++){\n    clearInterval(timers[i]);\n  }\n  timers=[];\n  const iconparts=  document.getElementsByClassName('comments-iconparts');\n  for(let i=0;i<iconparts.length;i++){\n    timers.push(randomMoveTimer(iconparts[i],1000));\n  }\n  return timers;\n}\n\nconst Comments=()=>{\n  const {comments,room,members} = useContext(roomContext);\n  var Path = window.location.pathname;\n\n  useEffect(()=>{\n    let target = document.getElementById('scroll-inner');\n    console.log(target);\n    target.scrollIntoView(false);\n  \n\n    let moveTimer=IconMove();\n  \n    return ()=>{\n      moveTimer.forEach(timer => {\n        clearInterval(timer);\n      });\n    }\n  })\n\n  return (\n    <div id='comments' className=\"list-group\">\n      <div id=\"scroll-inner\">\n        {comments && members &&\n          comments.map(comment=>(\n            <div key={comment.id.toString()} className=\"comment list-group-item d-flex\">\n              <div className='iconMask commentIcon'>\n                <Icon iconInfo={members[comment.userId]['iconInfo']} iconSize={iconSize} emotion={comment.emotion} where='comments'/>\n              </div>\n              <div>\n                {console.log(members)}\n                <strong className=\"userName mb-1\" style={{}}>{members[comment.userId]['displayName']}</strong>\n                <h3 className=\"commentContent\" style={{}}>{comment.content}</h3>\n              </div>\n            </div>\n          ))\n        }\n      </div>\n    </div>\n  );\n}\n\nexport default Comments;","const defaultIcons=[\n  {\n    'face'      : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'nomal'},\n    'hair'      : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'nomal'},\n    'leftEye'   : {posX : 90  , posY : 150 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'nomal'},\n    'rightEye'  : {posX : 160 , posY : 150 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'nomal'},\n    'nose'      : {posX : 120 , posY : 180 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'nomal'},\n    'mouth'     : {posX : 120 , posY : 210 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'nomal'},\n    'other'     : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'none'},\n  },\n  {\n    'face'      : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'henoheno'},\n    'hair'      : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'none'},\n    'leftEye'   : {posX : 90  , posY : 150 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'henoheno'},\n    'rightEye'  : {posX : 160 , posY : 150 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'henoheno'},\n    'nose'      : {posX : 120 , posY : 180 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'henoheno'},\n    'mouth'     : {posX : 120 , posY : 210 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'henoheno'},\n    'other'     : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'henoheno'},\n  },\n  {\n    'face'      : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'maru'},\n    'hair'      : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'cat'},\n    'leftEye'   : {posX : 90  , posY : 150 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'cat'},\n    'rightEye'  : {posX : 160 , posY : 150 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'cat'},\n    'nose'      : {posX : 120 , posY : 180 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'cat'},\n    'mouth'     : {posX : 120 , posY : 210 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'cat'},\n    'other'     : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'hige'},\n  },\n  {\n    'face'      : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'komugi'},\n    'hair'      : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'kaku'},\n    'leftEye'   : {posX : 90  , posY : 150 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'red'},\n    'rightEye'  : {posX : 160 , posY : 150 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'blue'},\n    'nose'      : {posX : 120 , posY : 180 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'pig'},\n    'mouth'     : {posX : 120 , posY : 210 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'fang'},\n    'other'     : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'horns'},\n  },\n  {\n    'face'      : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'monster'},\n    'hair'      : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 290 , rot : 0 , kind : 'tyuni'},\n    'leftEye'   : {posX : 90  , posY : 150 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'tyome'},\n    'rightEye'  : {posX : 160 , posY : 150 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'tyome'},\n    'nose'      : {posX : 120 , posY : 180 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'hole'},\n    'mouth'     : {posX : 120 , posY : 210 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'tooth'},\n    'other'     : {posX : 0   , posY : 0   , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'glasses'},\n  },\n];\nfunction GetIconRandom(){\n  return defaultIcons[Math.floor(Math.random() * Math.floor(defaultIcons.length))]\n}\n\n// パーツボタンの情報ズ。一応拡張性のためにKindsの中身2次元連想配列(？)にしてるけどいらないかも。\nconst partsData=\n{ \n  'face'      : { displayName : '顔'   , Kinds : {'henoheno' : {displayKind : 'じ'}, 'nomal' : {displayKind : 'フツー'} ,'monster' : {displayKind : '化物'},'komugi' : {displayKind : '小麦色'},'maru' : {displayKind : 'まる'} }} ,\n  'hair'      : { displayName : '髪'   , Kinds : { 'none' : {displayKind : 'なし'}   ,'nomal' : {displayKind : 'フツー'} ,'cat' : {displayKind : 'ケモミミ'},'tyuni' : {displayKind : '厨二'} ,'kaku' : {displayKind : 'カクガリ'}} } ,\n  'leftEye'   : { displayName : '左目' , Kinds : { 'henoheno' : {displayKind : 'への'},'no' : {displayKind : 'の'},'nomal' : {displayKind : 'フツー'} ,'cat' : {displayKind : 'ねこ'},'red' : {displayKind : '紅'},'blue' : {displayKind : '蒼'} ,'tyome' : {displayKind : 'コメ'}}} ,\n  'rightEye'  : { displayName : '右目' , Kinds : { 'henoheno' : {displayKind : 'への'},'no' : {displayKind : 'の'},'nomal' : {displayKind : 'フツー'},'cat' : {displayKind : 'ねこ'},'red' : {displayKind : '紅'},'blue' : {displayKind : '蒼'} ,'tyome' : {displayKind : 'コメ'}}} ,\n  'nose'      : { displayName : '鼻'   , Kinds : { 'henoheno' : {displayKind : 'も'},'nomal' : {displayKind : 'フツー'} ,'cat' : {displayKind : '逆三角'},'pig' : {displayKind : 'ぶたっぱな'} } },\n  'mouth'     : { displayName : '口'   , Kinds : { 'henoheno' : {displayKind : 'へ'},'nomal' : {displayKind : 'フツー'} ,'cat' : {displayKind : 'ダブリュー'},'fang' : {displayKind : '牙'},'tooth' : {displayKind : '歯'} }} ,\n  'other'     : { displayName : 'その他', Kinds : { 'none' : {displayKind : 'なし'},'horns' : {displayKind : 'ツノ'} ,'glasses' : {displayKind : 'めがね'},'henoheno' : {displayKind : 'へのへの'} }} ,\n}\nfunction GetPartsAll(){\n  return partsData;\n}\nfunction GetPartsData(partsName) {\n  return partsData[partsName];\n}\nfunction GetPartsKinds(partsName) {\n  console.log(partsName)\n  return partsData[partsName]['Kinds'];\n}\n// これがデータベースに保存される。今の値。stateが読み込まれたとき自動で上書きされてる。\nlet imgsInfo={\n  'face'      : {posX : 0 , posY : 0 , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'nomal'},\n  'hair'      : {posX : 0 , posY : 0 , sizeX : 300 , sizeY : 300 , rot : 0 , kind : 'nomal'},\n  'leftEye'   : {posX : 0 , posY : 0 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'nomal'},\n  'rightEye'  : {posX : 0 , posY : 0 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'nomal'},\n  'nose'      : {posX : 0 , posY : 0 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'nomal'},\n  'mouth'     : {posX : 0 , posY : 0 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'nomal'},\n  'other'     : {posX : 0 , posY : 0 , sizeX : 50  , sizeY : 50  , rot : 0 , kind : 'nomal'},\n};\nfunction GetImgsInfoEach(partsName,eachPram) {\n  return imgsInfo[partsName][eachPram];\n}\nfunction GetImgsInfoAll(partsName) {\n  return imgsInfo[partsName];\n}\nfunction GetImgsInfoAllAll() {\n  return imgsInfo;\n}\nfunction SetImgsInfoEach(partsName,eachPram,value) {\n  imgsInfo[partsName][eachPram]=value;\n}\nfunction SetImgsInfoAll(partsName,values) {\n  imgsInfo[partsName]=values;\n}\nfunction SetImgsInfoAllAll(values) {\n  imgsInfo=values;\n}\n\n// サイズの上限下限の設定\nconst partsSizeMaxMin={\n  'face'      : {max : 350 , min : 200 },\n  'hair'      : {max : 350 , min : 200 },\n  'leftEye'   : {max : 70  , min : 15  },\n  'rightEye'  : {max : 70  , min : 15  },\n  'mouth'     : {max : 100 , min : 15  },\n  'nose'      : {max : 100 , min : 15  },\n  'other'     : {max : 400 , min : 30  },\n};\nfunction GetSizeMax(partsName) {\n  return partsSizeMaxMin[partsName]['max'];\n}\nfunction GetSizeMin(partsName) {\n  return partsSizeMaxMin[partsName]['min'];\n}\nfunction GetSizeMaxMin(partsName) {\n  return partsSizeMaxMin[partsName];\n}\n\n// パーツの現在の大きさ。\nlet partsSizeNow={\n  'face'      : {sizeX : 300 , sizeY : 300 },\n  'hair'      : {sizeX : 300 , sizeY : 300 },\n  'leftEye'   : {sizeX : 30  , sizeY : 30  },\n  'rightEye'  : {sizeX : 30  , sizeY : 30  },\n  'mouth'     : {sizeX : 40  , sizeY : 40  },\n  'nose'      : {sizeX : 40  , sizeY : 40  },\n  'other'      : {sizeX : 300  , sizeY : 300  },\n}\nfunction GetSizeXYNow(partsName) {\n  return partsSizeNow[partsName];\n}\nfunction GetSizeXNow(partsName) {\n  console.log(partsName,partsSizeNow[partsName]['sizeX']);\n  return partsSizeNow[partsName]['sizeX'];\n}\nfunction GetSizeYNow(partsName) {\n  return partsSizeNow[partsName]['sizeY'];\n}\nfunction SetSizeXYNow(partsName,sizeX,sizeY) {\n  partsSizeNow[partsName]={sizeX : sizeX , sizeY : sizeY };\n}\nfunction SetSizeXNow(partsName,sizeX) {\n  partsSizeNow[partsName]['sizeX'] = sizeX;\n}\nfunction SetSizeYNow(partsName,sizeY) {\n  partsSizeNow[partsName]['sizeY'] = sizeY;\n}\n\n// パーツの回転の上限下限、今のところ意味ない\nconst partsRotMaxMin={\n  'face'      : {max : 360 , min : 0 ,},\n  'hair'      : {max : 360 , min : 0 ,},\n  'leftEye'   : {max : 360 , min : 0 ,},\n  'rightEye'  : {max : 360 , min : 0 ,},\n  'mouth'     : {max : 360 , min : 0 ,},\n  'nose'      : {max : 360 , min : 0 ,},\n  'other'     : {max : 360 , min : 0 ,},\n};\nfunction GetRotMax(partsName) {\n  return partsRotMaxMin[partsName]['max'];\n}\nfunction GetRotMin(partsName) {\n  return partsRotMaxMin[partsName]['min'];\n}\nfunction GetRotMaxMin(partsName) {\n  return partsRotMaxMin[partsName];\n}\n\n// パーツの現在の角度\nlet partsRotNow={\n  'face'      : 0,\n  'hair'      : 0,\n  'leftEye'   : 0,\n  'rightEye'  : 0,\n  'mouth'     : 0,\n  'nose'      : 0,\n  'other'      : 0,\n}\nfunction GetRotNow(partsName) {\n  return partsRotNow[partsName];\n}\nfunction SetRotNow(partsName,value) {\n  console.log(value);\n  partsRotNow[partsName]=value;\n}\n\nexport {\n  GetIconRandom,\n  GetPartsAll,GetPartsData,GetPartsKinds,\n  GetImgsInfoAllAll,GetImgsInfoAll,GetImgsInfoEach,SetImgsInfoAllAll,SetImgsInfoAll,SetImgsInfoEach,\n  GetSizeXYNow,GetSizeYNow,GetSizeXNow,SetSizeXYNow,SetSizeYNow,SetSizeXNow,\n  GetSizeMax,GetSizeMin,GetSizeMaxMin,\n  GetRotNow,SetRotNow,\n  GetRotMax,GetRotMin,GetRotMaxMin,\n}","import React, { useState, useContext  } from 'react';\nimport { act } from 'react-dom/test-utils';\nimport {GetPartsKinds} from '../IconData';\nimport {makeIconContext} from '../MakeIcon';\nimport '../makeIcon.css'\n\n\nconst PartsSelect=()=>{\n  const {setNowKind,nowKind,nowName} = useContext(makeIconContext);\n\n\n  return(\n    <div id=\"makeIconButtons\" className={nowName+\"button\"}>\n      {console.log(nowName)}\n      {Object.entries(GetPartsKinds(nowName)).map((value)=>(\n        <button \n          key={value[0]} \n          className={value[0]+\" \"+nowName+\" \"+\"iconKindButton btn-text-3d\"} \n          data-name={nowName} data-kind={value[0]}  \n          onClick={(e)=>{\n            setNowKind(e.target.dataset.kind);\n            document.getElementsByClassName('iconKindButton').forEach(activeElement => {\n              if(activeElement.classList.contains('active')){\n                activeElement.classList.remove('active');\n              }\n            });\n            e.target.classList.add('active');\n          }}\n        >{value[1][\"displayKind\"]}</button>\n      ))}\n    </div>\n  )\n}\n//  \n// data-partsName={nowName}\n\nexport default PartsSelect;","import React, {createContext, useContext, useState, useEffect} from 'react';\n//import {Link} from 'react-router-dom';\nimport axios from 'axios';\nimport './makeIcon.css'\nimport {GetImgsInfoAllAll, GetImgsInfoEach, GetPartsAll, GetRotMax, GetRotMin, GetRotNow, GetSizeMax, GetSizeMin, GetSizeXNow, SetImgsInfoAll, SetImgsInfoAllAll, SetRotNow, SetSizeNowAll, SetSizeXYNow} from './IconData';\nimport firebase,{db} from '../../../Firebase/Firebase'\nimport {userContext} from '../../../App';\nimport PartsSelect from './PartsSelect/PartsSelect';\n\nconst imgPath='./images/icon/';\n\nconst MakeIcon =()=> {\n  const [ nowKind , setNowKind ] = useState(null); \n  const [ nowName , setNowName ] = useState('face');\n  const [ nowSize , setNowSize ] = useState(30);\n  const [ nowRot  , setNowRot  ] = useState(0);\n \n  const {userInfo}=useContext(userContext);\n\n  useEffect(()=>{\n    if(userInfo){\n      // 今のアイコンの情報を描画したりデータにセットしたり。\n      SetImgsInfoAllAll(userInfo['iconinfo']);\n      Object.entries(userInfo['iconinfo']).forEach(partInfo => {\n        SetSizeXYNow(partInfo[0],partInfo[1]['sizeX'],partInfo[1]['sizeY']);\n        SetRotNow(partInfo[0],partInfo[1]['rot']);\n        let img=document.getElementById(partInfo[0]+'Img');\n        if(!img){\n          img = document.createElement('img');\n          img.classList.add('set-image');\n          img.classList.add(partInfo[0]);\n          img.id=partInfo[0]+'Img';\n        }\n        attach(img,partInfo[1]['sizeX'],partInfo[1]['sizeY'],partInfo[1]['posX'],partInfo[1]['posY'],partInfo[1]['rot'],partInfo[1]['kind'],partInfo[0]);\n      });\n    }\n    const facekind=GetImgsInfoEach(nowName,'kind');\n    // 選択してあるものをactiveに\n    document.getElementsByClassName('iconNameButton').forEach(activeElement => {\n      console.log(activeElement);\n      if(activeElement.classList.contains(nowName)){\n        activeElement.classList.add('active');\n      }\n    });\n    document.getElementsByClassName('iconKindButton').forEach(activeElement => {\n      if(activeElement.classList.contains(facekind)){\n        activeElement.classList.add('active');\n      }\n    });\n    setNowKind(GetImgsInfoEach(nowName,'kind'));\n  },[userInfo]);\n  \n  useEffect(()=>{\n    const facekind=GetImgsInfoEach(nowName,'kind');\n    document.getElementsByClassName('iconKindButton').forEach(activeElement => {\n      if(activeElement.classList.contains('active')){\n        activeElement.classList.remove('active');\n      }\n      if(activeElement.classList.contains(facekind)){\n        activeElement.classList.add('active');\n      }\n    });\n    setNowKind(facekind);\n  },[nowName])\n\n  // マウスが動いた時に画像を追従させる関数\n  const mouthmove = e =>{\n    // マウスの位置ー画像のサイズの半分で計算。\n    let mouseX = e.clientX-Math.floor(nowSize/2);\n    let mouseY = e.clientY-Math.floor(nowSize/2);\n    // 無限にレンダーがかかりそうなのでここはステートを使ってない\n    document.getElementById('traceImage').style.top  = mouseY + 'px';\n    document.getElementById('traceImage').style.left = mouseX + 'px';\n  }\n\n\n  // 画像を配置する関数\n  const attachByClick = e =>{\n    inputSizeSet();\n    inputRotSet();\n    let img=document.getElementById(nowName+'Img');\n    if(!img){\n      img = document.createElement('img');\n      img.classList.add('set-image');\n      //img.classList.add(nowName+'_'+nowKind);\n      img.classList.add(nowName+'Img');\n      img.id=(nowName);\n    }\n    let clientRect = document.getElementById('icon-space').getBoundingClientRect() ;\n\n    let px = window.pageXOffset + clientRect.left ;\n\n    // ページの上端から、要素の上端までの距離\n    let py = window.pageYOffset + clientRect.top ;\n    let mouseX =e.clientX;\n    let mouseY =e.clientY;\n\n    let x = mouseX-px-Math.floor(document.getElementById('sizeInput').value / 2);\n    let y = mouseY-py-Math.floor(document.getElementById('sizeInput').value / 2);\n    attach(img,document.getElementById('sizeInput').value,document.getElementById('sizeInput').value,x,y,document.getElementById('rotInput').value,nowKind,nowName)\n    document.getElementById('save-button').classList.add('active')\n  }\n  const attach=(img,sizex,sizey,x,y,rot,kind,name)=>{\n    img.src             = imgPath + kind + '_' + name + '.png';\n    img.style.width     = sizex + 'px';\n    img.style.height    = sizey + 'px';\n    img.style.position  = 'absolute';\n    img.style.left      = x + 'px';\n    img.style.top       = y + 'px';\n    img.style.transform = 'rotate('+rot+'deg)';\n    let values={\n      posX  : x     ,\n      posY  : y     ,\n      sizeX : sizex ,\n      sizeY : sizey ,\n      rot   : rot   ,\n      kind  : kind\n    };\n    document.getElementById('icon-space').appendChild(img);\n    SetImgsInfoAll(name,values);\n  }\n\n\n\n  // \n  const tracehide=()=>{\n    document.getElementById('traceImage').style.display = 'none';\n  }\n\n  function traceshow(){\n    document.getElementById('traceImage').style.display = 'block';\n  }\n\n  \n\n\n  let sizeTimer;\n  const sizeChange = (e) => {\n    if(sizeTimer){\n      clearTimeout(sizeTimer);\n    }\n    sizeTimer = setTimeout(inputSizeSet, 1000);\n      \n\n//      document.getElementById('traceImage').style.width = e.target.value+'px';\n//      document.getElementById('traceImage').style.height = e.target.value+'px';\n  }\n\n  let rotTimer;\n  const rotChange = (e) => {\n    if(rotTimer){\n      clearTimeout(rotTimer);\n    }\n\n    rotTimer = setTimeout(inputRotSet, 1000);\n      //document.getElementById('traceImage').style.transform ='rotate(' +e.target.value+'deg)';\n  }\n\n  // 回転をmaxminとかいい感じにてくれる関数\n  const inputRotSet=(name)=>{\n    if(!name){\n      name=nowName;\n    }\n    let input    = document.getElementById('rotInput');\n    let inputRot = input.value;\n    let nextRot;\n    let maxRot   = GetRotMax(name);\n    let minRot   = GetRotMin(name);\n\n    if(maxRot < inputRot){\n      nextRot=maxRot\n    }else if(minRot > inputRot){\n      nextRot=minRot\n    }else{\n      nextRot=inputRot\n    }\n    SetRotNow(name , nextRot);\n    setNowRot(nextRot);\n    input.value=nextRot;\n  }\n  // サイズをmaxminとかいい感じにてくれる関数\n  const inputSizeSet=(name)=>{\n    if(!name){\n      name=nowName;\n    }\n    let input     = document.getElementById('sizeInput');\n    let inputSize = input.value;\n    let nextSize;\n    let maxSize   = GetSizeMax(name);\n    let minSize   = GetSizeMin(name);\n    \n    if(maxSize < inputSize){\n      nextSize = maxSize\n    }else if(minSize > inputSize){\n      nextSize = minSize;\n    }else{\n      nextSize = inputSize;\n    }\n    SetSizeXYNow(name , nextSize , nextSize);\n    setNowSize(nextSize);\n    input.value=nextSize;\n  }\n\n  const {userId} = useContext(userContext);\n    return (\n      <div id=\"makeIcon\">\n        {userInfo===null&&\n          <p>loading infos...</p>\n        }\n        {userInfo!==null&&\n          <makeIconContext.Provider value = {{nowKind , setNowKind , nowName , setNowName , nowSize , setNowSize , nowRot , setNowRot}}>\n          <div  id = \"icon-space\" className=\"iconMask\"  onMouseMove = {mouthmove}  onMouseLeave = {tracehide}  onMouseEnter = {traceshow}  onClick = {attachByClick} />\n          {console.log(imgPath + nowKind + nowName + \"png\")}\n          <img  id = \"traceImage\"  src = { imgPath + nowKind + \"_\" + nowName + \".png\" }  style = {{ height : nowSize + \"px\" , width : nowSize + \"px\", zIndex : \"100\", position : \"absolute\", display : \"none\", cursor : \"none\", pointerEvents : \"none\",transform : \"rotate(\" + nowRot + \"deg)\" }}>\n          </img>\n          <div>\n            回転\n            <input  type = \"number\"  id = \"rotInput\"  onInput = {rotChange}   min = {GetRotMin(nowName)}  max = {GetRotMax(nowName)} defaultValue = \"0\"></input>\n            サイズ\n            <input  type = \"number\"  id = \"sizeInput\"  onInput = {sizeChange}  min = {GetSizeMin(nowName)}  max = {GetSizeMax(nowName)}  defaultValue = \"30\"></input>\n          </div>\n          <div  id = \"name-buttons\" className=\"\">\n          {Object.entries(GetPartsAll()).map((value) => (\n            // 「顔」とか「髪」とかのボタンを描画。\n            <button  key = {value[0]} id={value[0]+\"IconNameButton\"}  className = {value[0]+\" \"+\"iconNameButton btn-border_buttom\"}  data-name = {value[0]}  \n              onClick = {(e)=>{\n                // 「顔」とかのボタンの今までアクティブついてたの消して、今押されたやつにactiveを追加。その他サイズや回転なども変更\n                document.getElementsByClassName('iconNameButton').forEach(activeElement => {\n                  if(activeElement.classList.contains('active')){\n                    activeElement.classList.remove('active');\n                  }\n                });\n                setNowName(e.target.dataset.name);\n                setNowKind(GetImgsInfoEach(e.target.dataset.name,'kind'));\n                document.getElementById('sizeInput').value=GetSizeXNow(e.target.dataset.name);\n                document.getElementById('rotInput').value=GetRotNow(e.target.dataset.name);\n                inputSizeSet(e.target.dataset.name);\n                inputRotSet(e.target.dataset.name);\n              }}\n            >{value[1][\"displayName\"]}</button>\n          ))}\n          </div>\n          <PartsSelect />\n          </makeIconContext.Provider>\n          }\n      </div>\n    )\n}\nconst makeIconContext = createContext([])\nexport {makeIconContext};\nexport default MakeIcon;","import firebase,{db} from '../Firebase/Firebase';\nimport {Redirect} from 'react-router-dom';\nimport {useContext} from 'react';\nimport { setIsFirst, userContext } from '../App';\nimport { GetIconRandom } from './UserInfo/MakeIcon/IconData';\n\nconst NoLogin=()=>{\n  const {setUserId,setUserName,setIsOnline,isOnline} = useContext(userContext);\n\n  const logoutFromGoogle = () => { \n    firebase.auth().signOut();\n    setIsOnline(false);\n    setUserId(null);\n  }\n\n\n  // ログイン処理\n  const loginWithGoogle = () => {\n    // もうauthにアカウントがあるかとかかな？...\n    setIsFirst(true);\n    firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)\n    .then(function() {\n\n      const provider = new firebase.auth.GoogleAuthProvider();\n\n      // サインインしてもらう\n      firebase.auth().signInWithPopup(provider)\n      .then(async function(result) {\n        await db.collection('/users').where('userId','==',result.user.uid).get().then(function(doc) {\n          console.log(doc);\n          // まだアカウントないなら\n          if (doc.empty) {\n            console.log(\"No user\");\n            db.collection('users').doc(result.user.uid).set({\n              userId      : result.user.uid,\n              displayName : 'ゲスト',\n              oneWord     : '',\n              room        : null,\n              rooms       : [],\n              iconinfo    :(GetIconRandom())\n            }).then(async (doc)=>{\n              await db.collection('users').doc(result.user.uid).collection('seclet').doc(result.user.uid).set({\n                userName : result.user.displayName,\n                email    : result.user.email,\n              }).then(()=>{\n                console.log('login fin');    \n                setIsOnline(true);\n                setUserId(result.user.uid);\n              }).catch((error)=>{\n                db.collection('users').doc(result.user.uid).delete().then(()=>{\n                  logoutFromGoogle();\n                  alert('エラーが発生しました、もう一度ログインをお願いします。Error:'+error);\n                  console.log(error);\n                })\n              })\n            }).catch((error)=>{\n              logoutFromGoogle();\n              alert('エラーが発生しました、もう一度ログインをお願いします。Error:'+error);\n              console.log(error);\n            })\n          }else{\n            setIsOnline(true);\n            setUserId(result.user.uid);\n          }\n        })\n        .catch(function(error) {\n          console.log(\"Error : \", error);\n        });\n      }.bind(this))\n        .catch(function(error) {\n          alert(\"Googleでサインインできませんでした。 Error: \" , error);\n          console.log(error);\n          return false;\n        }\n      );\n    }.bind(this));\n  }\n  \n  return(\n    <div>\n      {isOnline === true &&\n        <div>\n          ログインしました！\n          <Redirect to = \"/userSetting\"/>\n        </div>\n      }\n      {isOnline === false &&\n        <div>\n          ログインしていません\n          <button onClick = {loginWithGoogle}>\n            Googleでログイン\n          </button>\n        </div>\n      }\n      {isOnline === null &&\n        <>loading aouth...</>\n      }\n    </div>\n    \n  )\n}\n\nexport default NoLogin;","import React, { Component,getState, createContext,useContext,useState,useEffect } from 'react';\nimport { BrowserRouter as Router, Redirect, Route, RouteProps, Switch } from 'react-router-dom';\nimport NavBar from './NavBar/NavBar';\nimport Comments from './Room/Comments/Comments';\nimport MakeIcon from './UserSettings/UserInfo/MakeIcon/MakeIcon';\nimport UserSettings from './UserSettings/UserSettings';\nimport Room from './Room/Room';\nimport Main from './Main/Main';\nimport { useWorker } from 'react-hooks-worker';\n\nimport {googleauthConfig} from './miserarenaiyo';\nimport firebase, { db } from './Firebase/Firebase';  \nimport NoLogin from './UserSettings/NoLogin';\nimport Error from './Error/Error';\n\n//ユーザー系のcontext\nexport const userContext=createContext();\n\nlet isFirst=false;\n\nconst App = () => {\n  //ユーザー系のステート\n  const [isOnline , setIsOnline] = useState(null);\n  const [userId   , setUserId  ] = useState(null);\n  const [userInfo , setUserInfo] = useState(null);\n  \n  useEffect(() => {\n    async function getUserInfo(){\n      if(userId){\n        const userInfoUnsubscribe = await db.collection('users').doc(userId).onSnapshot(doc=>{\n          db.collection('users').doc(userId).collection('seclet').doc(userId).get().then(seclet=>{\n            let data=doc.data();\n            let secletdata=seclet.data();\n            setUserInfo({\n              userName    : secletdata['userName'] ,\n              email       : secletdata['email']    ,\n              displayName : data['displayName']    ,\n              oneWord     : data['oneWord']        ,\n              iconinfo    : data['iconinfo']       ,\n              rooms       : data['rooms']          ,\n              room        : data['room']\n            });\n          });\n        });\n        return () => userInfoUnsubscribe();\n      }\n    }\n    getUserInfo();\n  },[userId]);\n\n  useEffect(() => {\n    //ログイン時にステート更新する処理\n    firebase.auth().onAuthStateChanged(async function (user) {\n      let isOnline = false;\n      let userId = null;\n      if (user) {\n        userId   = user.uid;\n        isOnline = true;\n      }\n      // 初回ログイン時、データの追加より先に、stateが更新され、エラーになってしまうため、その対策。\n      if(!isFirst){\n        setUserId(userId);\n        setIsOnline(isOnline);\n      };\n      //this.setState({isOnline:isOnline})\n      //this.setState({userId:userId})\n    }.bind(this));\n  })\n  // ルーティングはここでやる\n  return (\n      <div>\n      <userContext.Provider value={{isOnline , setIsOnline , userId , setUserId, userInfo , setUserInfo }}>\n        <NavBar/>\n        <Switch>\n          <Route exact path = '/login' component = {NoLogin} /> \n          {isOnline === false &&<Redirect to = {'/login'} />}\n          {isOnline === true &&\n            <Switch>\n              <Route exact path='/error'       component = {Error}/>\n              <Route exact path='/'            component = {Main}/>\n              <Route exact path='/userSetting' component = {UserSettings}/>\n              <Route exact path='/room/:id'    component = {Room}/>\n              <Redirect to = {'/error'} />\n            </Switch>\n          }\n          <>loading...</>\n        </Switch>\n      </userContext.Provider>\n      </div>\n  );\n}\n\n\n\n\n\n/**\n * \n * <Auth>\n            <Switch>\n            </Switch>\n          </Auth>\n          \n *  */\n//export {UserContext};\nexport function setIsFirst(newValue){\n  isFirst=newValue;\n}\nexport default App;\n","import firebase,{db} from '../../Firebase/Firebase';\nimport {userContext} from '../../App';\nimport {useContext,useEffect,useState} from 'react';\nimport { SettingContext } from '../UserSettings';\nimport { Redirect } from 'react';\nimport { GetImgsInfoAllAll } from './MakeIcon/IconData';\n//import logoutFromGoogle from '../Logout';\nimport './loggedIn.css'\n\nconst Loggedin=()=>{\n  const {setIsOnline , isOnline , setUserId , userId ,userInfo} = useContext(userContext);\n  \n  const logoutFromGoogle = () => { \n    firebase.auth().signOut();\n    setIsOnline(false);\n    setUserId(null);\n    document.location.reload();\n  }\n\n  const changeInfoAPI = () =>{\n    if(document.getElementById('save-button').classList.contains('active')){\n      const newDisplayName = document.getElementById('displayName-input').value;\n      const newOneWordName = document.getElementById('oneWord-input').value;\n      db.collection('users').doc(userId).update({\n        displayName : newDisplayName,\n        oneWord     : newOneWordName,\n      }).then((doc)=>{\n        let value=GetImgsInfoAllAll();\n        db.collection('users').doc(userId).update({\n          iconinfo:value\n        }).then(()=>{\n          document.location.reload();\n        }).catch(error => {\n          // error\n          console.log(error)\n        });\n      }).catch((error)=>{\n        logoutFromGoogle();\n        alert('エラーが発生しました。申し訳ありませんが、もう一度ログインをお願いします。Error:'+error);\n        console.log(error);\n      })\n    }\n  }\n\n  return(\n    <div>\n      {userInfo===null&&\n        <p>Loading userInfo...</p>\n      }\n      {userInfo&&\n        <div>\n          <ul>\n            <li><h4>表示名</h4><input id=\"displayName-input\" type=\"text\" maxLength=\"15\" defaultValue={userInfo['displayName']} \n            onChange={()=>{\n              document.getElementById('save-button').classList.add('active')\n            }}></input></li>\n            <li><h4>ひとこと</h4><h3><input id=\"oneWord-input\" type=\"text\" maxLength=\"30\" defaultValue={userInfo['oneWord']}\n            onChange={()=>{\n              document.getElementById('save-button').classList.add('active')\n            }}></input></h3></li>\n            <li><h4>名前</h4><h3>{userInfo['userName']}</h3></li>\n            <li><h4>メールアドレス</h4><h3>{userInfo['email']}</h3></li>\n            <li><h4>Googleでログインしています</h4><button onClick = {logoutFromGoogle}>ログアウト</button></li>\n          </ul>    \n          <>設定が終わったら、</><a href=\"/\">ホーム</a><>に移動してルームに参加してみましょう！</><br/>\n          <a id=\"save-button\" onClick = {changeInfoAPI} >変更を保存</a>\n        </div>\n      }\n    </div>\n  )\n}\n\n\nexport default Loggedin;","import React, {Component,useContext,createContext,useState,useEffect} from 'react';\nimport { BrowserRouter as Router, Redirect, Route, RouteProps, Switch } from 'react-router-dom';\n\nimport axios from 'axios';\nimport MakeIcon from './UserInfo/MakeIcon/MakeIcon';\nimport {userContext} from '../App'\n\nimport firebase, { db } from '../Firebase/Firebase';  \nimport NoLogin from './NoLogin';\nimport Loggedin from './UserInfo/LoggedIn';\n\nimport './usersettings.css';\n//import logoutFromGoogle from './Logout';\n\n\nconst UserSettings = () =>{\n  const {isOnline,setIsOnline,userId,setUserId,userInfo,setUserInfo} = useContext(userContext);\n  \n  const logoutFromGoogle = () => { \n    firebase.auth().signOut();\n    setIsOnline(false);\n    setUserId(null);\n  }\n\n  return (\n      <div>\n        {isOnline===null &&\n          <p>loading....</p>\n        }\n        {isOnline === true &&\n          <div id=\"settings\">\n            <MakeIcon />\n            <Loggedin />\n          </div>\n        }\n        {isOnline === false &&\n          <NoLogin/>\n        }\n      </div>\n  );\n}\nexport default UserSettings;\n","import { useEffect } from \"react\";\nimport randomMoveTimer from \"../../IconRandomMove\";\nimport Icon from \"../../IconRender\";\nimport { GetIconRandom } from \"../../UserSettings/UserInfo/MakeIcon/IconData\";\nimport './introduce.css'\n\n\nconst IconMove=()=>{\n  let timers=[];\n  for(let i=0;i<timers.length;i++){\n    clearInterval(timers[i]);\n  }\n  timers=[];\n  const iconparts=  document.getElementsByClassName('intro-iconparts');\n  for(let i=0;i<iconparts.length;i++){\n    timers.push(randomMoveTimer(iconparts[i],1000));\n  }\n  return timers;\n}\n\n\nconst Introduce = () => {\n  useEffect(()=>{\n    let moveTimer=IconMove();\n    return ()=>{\n      moveTimer.forEach(timer => {\n        clearInterval(timer);\n      });\n    }\n  });\n\n  return (\n    <div className=\"bs-component\">\n\t\t\t<div id=\"intoro-box\">\n        <Icon iconInfo={GetIconRandom()} where=\"intro\" iconSize=\"200\" />\n        <div id=\"intro-texts\">    \n\t\t\t\t  <h2>「エモいチャット。」へようこそ！</h2>\n\t\t\t\t  <p id=\"text\">エモいチャットとはエモートや、リアクション機能を搭載し、より「話してる感」を味わえるありそうでなかったチャットです！</p>\n        </div>\n      </div>\n\t\t</div>\n  )\n}\n\nexport default Introduce;","import React,{useContext} from 'react';\nimport firebase,{db} from '../../Firebase/Firebase';\nimport {userContext} from '../../App';\nimport './roomform.css';\n\nconst RoomForm = () =>{\n  const {userId,userInfo} =useContext(userContext);\n\n  const roomAPI=()=>{\n    let roomName = document.getElementById('nameInput').value;\n    if(roomName.length > 0 && roomName.length<=15){\n      let StageId  = document.getElementById('stage-select').value;\n      db.collection('/rooms').add({\n        roomName     : roomName,\n        stageId      : StageId,\n        madeUserId   : userId,\n        madeUserName : userInfo['displayName'],\n        timeStamp    : firebase.firestore.FieldValue.serverTimestamp(),\n        members      : []\n      }).then((docs) => {\n        document.location.reload();\n      }).catch(error => {\n        // error\n        alert('エラーが発生しました。申し訳ありませんが、しばらく待ってもう一度お試しください\\nError:'+error)\n      });\n    }else{\n      alert('ルーム名は1文字以上、15文字以下である必要があります。');\n    }\n  }\n\n  return(\n    <div id=\"room-form\">\n      <label htmlFor=\"name\" >ルームの名前</label>\n      <input id=\"nameInput\" type=\"text\" name=\"name\" maxLength=\"15\" /><br/>\n      {\n        //ステージ未実装のため、ここは表示されません。\n      }\n      <label id=\"select-label\" htmlFor=\"stage\" defaultValue=\"0\">ステージ</label>\n      <select id=\"stage-select\" name=\"stage\" className=\"custom-select\">\n        <option value=\"0\">Zero</option>\n        <option value=\"1\">One</option>\n        <option value=\"2\">Two</option>\n      </select><br/>\n      <button onClick = {roomAPI}>投稿</button>\n    </div>\n  )\n}\nexport default RoomForm;","import React, {Component,useState,useEffect,current} from 'react';\nimport {Link} from 'react-router-dom';\nimport axios from 'axios';\nimport firebase, { db } from '../../Firebase/Firebase';  \nimport SplitPane from 'react-split-pane';\nimport RoomForm from '../RoomForm/RoomForm';\nimport '../Rooms/rooms.css'\n\nconst Rooms = () => {\n\n  const [rooms,setRooms]=useState(null);\n  \n  useEffect(() => {\n    let unmounted=false;\n    async function roomsData() {\n      // ルームのデータを取得。\n      const unsubscribe = await db.collection('/rooms').orderBy('timeStamp', 'asc').get().then(col=> {\n        if(!unmounted){\n          // idを配列に\n          let roomids=col.docs.map(postCol => \n            postCol.id\n          );\n          // データの中身を取得\n          let value=[];\n          col.forEach((postCol) => {\n            value.push(\n              postCol.data()\n            );\n          });\n          /* 本来は変わった部分だけいい感じにすべきなんだろうけど...時間足らず...\n          col.docChanges().forEach(change => {\n            console.log(change.doc.data());\n          });\n          */\n          let rooms=[];\n          // idとデータを合体\n          for(let i = 0; i < roomids.length; i++){\n            let d = value[i][\"timeStamp\"].toDate();\n            rooms.push({\n                roomName     : value[i][\"roomName\"],\n                stageId      : value[i][\"stageId\"],\n                madeTime     : d.getFullYear()+'/'+d.getMonth() + 1+'/'+d.getDate(),\n                madeUserName : value[i][\"madeUserName\"],\n                madeUserId   : value[i][\"madeUserId\"],\n                members      : value[i][\"members\"],\n                id           : roomids[i],\n              }\n            )\n          }\n          setRooms(rooms);\n        }\n      });// ...\n    };\n\n    roomsData();\n  }, []);\n  return (\n    <div id=\"rooms\" className=\"list-group\">\n      {rooms === null && <p>Loading rooms...</p>}\n      {rooms && \n        rooms.map(room => (\n          <li key={room.id} className=\"roomsItem list-group-item d-flex\">\n            <Link to={`/room/${room.id}`}>\n              <h4 >{room.roomName}</h4>\n            </Link>\n            <h4 >作成者：{room.madeUserName}</h4>\n            <h4 >作成日時：{room.madeTime}</h4>\n            <h4 >メンバー：{room.members.length}人</h4>\n          </li>\n        ))\n      }\n      {rooms && rooms.length === 0 &&\n        <li key={\"none room\"} className=\"roomsItem list-group-item d-flex\">\n           <h4>まだルームはありません</h4>\n        </li>\n      }\n      \n\t  </div>\n  )\n}\n\nexport default Rooms;","import React from 'react';\nimport SplitPane from 'react-split-pane';\nimport Introduce from './Introduce/Introduce';\nimport RoomForm from './RoomForm/RoomForm';\nimport Rooms from './Rooms/Rooms';\n\nconst Main = () => {\n  return (\n    <div id=\"roomsAndForm\">\n      <Introduce></Introduce>\n      <Rooms />\n      <RoomForm />\n    </div>\n  )\n}\nexport default Main;","const Error=()=>{\n  return(\n    <div>\n      <p>ページが見つかりませんでした。削除・変更されたか、URLが間違っている可能性があります。</p>\n    </div>\n  )\n}\n\nexport default Error;","import React,{createContext,useState} from 'react';\nimport ReactDOM from 'react-dom';\nimport {BrowserRouter} from 'react-router-dom';\nimport App from './App';\nimport './index.css'\n//import User from './User';\n//import { createStore } from 'redux'\n//import todoApp from './reducers/test.js'\n//let store = createStore(todoApp)\n\n//import * as serviceWorker from './serviceWorker';\n\n\nReactDOM.render(\n    <BrowserRouter>\n        <App />\n    </BrowserRouter>\n, document.getElementById('root'));\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\n//serviceWorker.unregister();"],"sourceRoot":""}